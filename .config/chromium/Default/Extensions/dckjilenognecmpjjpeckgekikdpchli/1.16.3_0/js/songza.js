if("undefined"==typeof runningsongza){var runningsongza=!0,exports={};!function(){var e={},t={},n=2;chrome.storage.local.get(null,function(t){e=t,0==--n&&y()}),chrome.storage.sync.get(null,function(e){if(t=e,!t.test)for(var o in console)console[o]=function(){};0==--n&&y()});var o=function(n,o){if("local"==o)for(var i in n)e[i]=n[i].newValue;else if("sync"==o)for(var i in n)t[i]=n[i].newValue};chrome.storage.onChanged.addListener(o);var i=function(e,t,n){t=t||0,n=n||0;var o=document.createEvent("MouseEvents");o.initMouseEvent("mousedown",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("click",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("mouseup",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o)};window.MutationObserver=window.MutationObserver||window.WebkitMutationObserver;var a={},r=null,s={},l={},u={},c=!1,p=function(e,t,n){return n&&t===s[e]?void 0:s[e]=t};l.isplaying=function(e){return p("isplaying",!document.querySelector(".player-state-pause"),e)},l.song=function(e){var t=document.querySelector(".miniplayer-info-track-title");return p("song",t?t.innerText:"",e)},l.artist=function(e){var t=document.querySelector(".miniplayer-info-artist-name");return p("artist",t?t.innerText.replace(/^by /,""):"",e)},l.album=function(e){var t=document.querySelector(".miniplayer-info-album-title");return p("album",t?t.innerText.replace(/^from /,""):"",e)},l.albumart=function(e){var t=document.querySelector(".miniplayer-album-art");return p("albumart",t?t.src.replace(/s\.jpeg$/,"g.jpeg"):"",e)},l.songvote=function(e){return p("songvote",document.querySelector(".miniplayer-track-action.thumb-up.voted")?1:document.querySelector(".miniplayer-track-action.thumb-down.voted")?-1:0,e)},l.volume=function(e){var t=document.querySelector(".miniplayer-volume-slider .range-quantity");return p("volume",t?parseInt(t.style.height)/72:1,e)},l.playlists=function(e){return p("playlists",[l.playlist()],e)},l.playlist=function(e){var t=document.querySelector(".miniplayer-info-playlist-title");return p("playlist",t?t.innerText:"",e)},l.elapsedratio=function(e){var t=document.querySelector(".miniplayer-timeline-current-time");return p("elapsedratio",t?parseFloat(t.style.width)/100:0,e)},l.elapsedtime=function(e){if(l.elapsedratio(!0)){var t=Date.now()/1e3;!s.elapsedsave||!s.elapsedsavetime||s.elapsedratio<=s.elapsedsave||t>s.elapsedsaveping+2?(s.durationcalc=0,s.elapsedsave=s.elapsedratio,s.elapsedsavetime=t):t>s.elapsedsavetime&&(s.durationcalc=(t-s.elapsedsavetime)/(s.elapsedratio-s.elapsedsave)),s.elapsedsaveping=t}return p("elapsedtime",s.durationcalc?s.durationcalc*s.elapsedratio:0,e)},l.totaltime=function(e){return p("totaltime",s.durationcalc||0,e)},u.play=function(){c=!1,i(document.querySelector(".player-state-pause .miniplayer-control-play-pause"))},u.pause=function(){i(document.querySelector(".player-state-play .miniplayer-control-play-pause"))},u.forcepaused=function(){c=!0,u.pause();var e=function(){c=!1,document.querySelector(".miniplayer-control-play-pause").removeEventListener("click",e,!0),document.querySelector(".miniplayer-control-skip").removeEventListener("click",e,!0)};document.querySelector(".miniplayer-control-play-pause").addEventListener("click",e,!0),document.querySelector(".miniplayer-control-skip").addEventListener("click",e,!0)},u.prev=function(){c=!1},u.next=function(){c=!1,i(document.querySelector(".miniplayer-control-skip"))},u.songvote=function(e){1==e&&i(document.querySelector(".miniplayer-track-action.thumb-up")),-1==e&&i(document.querySelector(".miniplayer-track-action.thumb-down"))},u.volume=function(e){var t=document.querySelector(".miniplayer-volume-slider"),n=t.style.display;t.style.display="block";var o=document.querySelector(".miniplayer-volume-slider .range-bar"),i=0,a=o;do i+=a.offsetTop;while(a=a.offsetParent);i+=document.querySelector(".top-spacer").offsetHeight;var r=i+18+72*(1-e),s=document.querySelector(".miniplayer-volume-slider .range-handle"),l=i+(90-parseInt(s.style.bottom)),u=1,c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",!0,!0,window,1,0,0,u,l,!1,!1,!1,!1,0,null),s.dispatchEvent(c),setTimeout(function(){c=document.createEvent("MouseEvents"),c.initMouseEvent("mousemove",!0,!0,window,1,0,0,u,r,!1,!1,!1,!1,0,null),s.dispatchEvent(c),c=document.createEvent("MouseEvents"),c.initMouseEvent("mouseup",!0,!0,window,1,0,0,u,r,!1,!1,!1,!1,0,null),s.dispatchEvent(c),t.style.display=n},0)},u.seek=function(){},u.playlist=function(){};var m=function(){console.log("]]connect-songza"),r=chrome.extension.connect({name:JSON.stringify({name:"playerport",type:"songza",isplaying:l.isplaying(),song:l.song(),artist:l.artist(),album:l.album(),albumart:l.albumart(),songvote:l.songvote(),volume:l.volume(),playlists:l.playlists(),playlist:l.playlist()})}),r.onMessage.addListener(d),r.onDisconnect.addListener(v),r._postMessage=r.postMessage,r.postMessage=function(){try{r._postMessage.apply(r,arguments)}catch(e){v()}},a={},a.miniplayer=new MutationObserver(function(){var t={};t.song=l.song(!0),t.artist=l.artist(!0),t.album=l.album(!0),t.albumart=l.albumart(!0),t.isplaying=l.isplaying(!0),t.playlist=l.playlist(!0),t.songvote=l.songvote(!0),t.elapsedTime=l.elapsedtime(!0),t.totalTime=l.totaltime(!0),t.volume=l.volume(!0),r.postMessage(t),t.song&&e()}),a.miniplayer.observe(document.querySelector("#player"),{subtree:!0,childList:!0});var e=function(){a.playpause&&a.playpause.disconnect(),a.playpause=new MutationObserver(function(){void 0!==l.isplaying(!0)&&(c&&s.isplaying?u.forcepaused():r.postMessage({isplaying:s.isplaying}))}),a.playpause.observe(document.querySelector(".player-wrapper"),{attributes:!0,attributeFilter:["class"]}),a.songvote&&a.songvote.disconnect(),a.songvote=new MutationObserver(function(){void 0!==l.songvote(!0)&&r.postMessage({songvote:s.songvote})}),document.querySelector(".miniplayer-track-actions")&&a.songvote.observe(document.querySelector(".miniplayer-track-actions"),{subtree:!0,attributes:!0,attributeFilter:["class"]}),a.volume&&a.volume.disconnect(),a.volume=new MutationObserver(function(){void 0!==l.volume(!0)&&r.postMessage({volume:s.volume})}),a.volume.observe(document.querySelector(".miniplayer-volume-slider"),{subtree:!0,attributes:!0,attributeFilter:["style"]}),a.time&&a.time.disconnect(),a.time=new MutationObserver(function(){void 0!==l.elapsedtime(!0)&&r.postMessage({elapsedTime:s.elapsedtime,totalTime:l.totaltime()})}),a.time.observe(document.querySelector(".miniplayer-timeline-current-time"),{attributes:!0,attributeFilter:["style"]})};e()},v=function(){if(r)try{r.disconnect()}catch(e){}r=null,runningsongza=void 0;for(var t in a)a[t].disconnect();chrome.storage.onChanged.removeListener(o)},d=function(e){"play"==e.action&&u.play(),"pause"==e.action&&u.pause(),"forcepaused"==e.action&&u.forcepaused(),"prev"==e.action&&u.prev(),"next"==e.action&&u.next(),"thumbup"==e.action&&u.songvote(1),"thumbdown"==e.action&&u.songvote(-1),"setvolume"==e.action&&u.volume(e.volume),"seek"==e.action&&u.seek(e.seek),"setplaylist"==e.action&&u.playlist(e.playlist)},y=function(){var e=function(){return document.querySelector(".miniplayer-control-play-pause")?void m():setTimeout(e,500)};setTimeout(e,10)}}()}