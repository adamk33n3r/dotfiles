if("undefined"==typeof runningslacker){var runningslacker=!0,exports={};!function(){var e={},t={},n=2;chrome.storage.local.get(null,function(t){e=t,0==--n&&b()}),chrome.storage.sync.get(null,function(e){if(t=e,!t.test)for(var o in console)console[o]=function(){};0==--n&&b()});var o=function(n,o){if("local"==o)for(var a in n)e[a]=n[a].newValue;else if("sync"==o)for(var a in n)t[a]=n[a].newValue};chrome.storage.onChanged.addListener(o);var a=function(e,t,n){if(e){t=t||0,n=n||0;var o=document.createEvent("MouseEvents");o.initMouseEvent("mousedown",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("click",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("mouseup",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o)}};window.MutationObserver=window.MutationObserver||window.WebkitMutationObserver;var r={},i=null,s={},l={},u={},c=!1,p=function(e,t,n){return n&&t===s[e]?void 0:s[e]=t};l.isplaying=function(e){var t=document.querySelector("#player .playpause.play");return p("isplaying",!!t,e)},l.song=function(e){var t=document.querySelector("#player .metadata .link:first-child");return p("song",t?t.innerText.replace(/\s/g," ").trim():"",e)},l.artist=function(e){var t=document.querySelector("#player .metadata .link:last-child");return p("artist",t?t.innerText.replace(/\s/g," ").trim():"",e)},l.album=function(e){return p("album","",e)},l.albumart=function(e){var t=document.querySelector("#player .art img");return p("albumart",t?t.src.replace(/\/\d+\./,"/500."):"",e)},l.songvote=function(e){return p("songvote",document.querySelector("#player .love .hearted")?1:document.querySelector("#player .banning .banned")?-1:0,e)},l.volume=function(e){var t=document.querySelector("#player .volume .noUi-origin");return p("volume",t?parseFloat(t.style.left)/100:1,e)},l.playlists=function(e){var t=[l.playlist()];return p("playlists",t,e)},l.playlist=function(e){var t=document.querySelector("#player .stationname .link");return p("playlist",t?t.innerText:"",e)},l.elapsedtime=function(e){var t=document.querySelector("#player #progressContainer > span:first-child");return t=t?t.innerText.trim().match(/^(\d*\d):(\d\d)$/):void 0,t=t?60*t[1]+1*t[2]:void 0,p("elapsedtime",t||0,e)},l.totaltime=function(e){var t=document.querySelector("#player #progressContainer > span:last-child");return t=t?t.innerText.trim().match(/^(\d*\d):(\d\d)$/):void 0,t=t?60*t[1]+1*t[2]:void 0,p("totaltime",l.elapsedtime()+t||1,e)},l.moderepeat=function(e){return p("moderepeat",!1,e)},l.modeshuffle=function(e){return p("modeshuffle",!1,e)},l.adwatch=function(e){return p("adwatch",!1,e)},u.play=function(){c=!1,a(document.querySelector("#player .playpause a.play"))},u.pause=function(){a(document.querySelector("#player .playpause a.pause"))},u.forcepaused=function(){c=!0,u.pause();var e=function(){c=!1,document.querySelector("#player .playpause a").removeEventListener("click",e,!0),document.querySelector("#player .skip-forward a").removeEventListener("click",e,!0),document.querySelector("#player .skip-back a").removeEventListener("click",e,!0)};document.querySelector("#player .playpause a").addEventListener("click",e,!0),document.querySelector("#player .skip-forward a").addEventListener("click",e,!0),document.querySelector("#player .skip-back a").addEventListener("click",e,!0)},u.prev=function(){c=!1,a(document.querySelector("#player .skip-back a"))},u.next=function(){c=!1,a(document.querySelector("#player .skip-forward a"))},u.songvote=function(e){e>0||0==e&&document.querySelector("#player .love .hearted")?a(document.querySelector("#player .love a:first-child")):(0>e||0==e&&document.querySelector("#player .banning .banned"))&&a(document.querySelector("#player .banning a:first-child"))},u.volume=function(e){var t=document.querySelector("#player .volume .noUi-base"),n=0,o=t;do n+=o.offsetLeft;while(o=o.offsetParent);n+=t.offsetWidth*e,a(t,n,0)},u.seek=function(){},u.playlist=function(){},u.moderepeat=function(){},u.modeshuffle=function(){};var d=function(){console.log("]]connect-slacker"),i=chrome.extension.connect({name:JSON.stringify({name:"playerport",type:"slacker",isplaying:l.isplaying(),song:l.song(),artist:l.artist(),album:l.album(),albumart:l.albumart(),songvote:l.songvote(),volume:l.volume(),playlists:l.playlists(),playlist:l.playlist(),moderepeat:l.moderepeat(),modeshuffle:l.modeshuffle()})}),i.onMessage.addListener(g),i.onDisconnect.addListener(f),i._postMessage=i.postMessage,i.postMessage=function(){try{i._postMessage.apply(i,arguments)}catch(e){f()}},window.addEventListener("pushstate",m,!0),window.addEventListener("popstate",m,!0),r={},r.playpause=new MutationObserver(function(){void 0!==l.isplaying(!0)&&(c&&s.isplaying?u.forcepaused():i.postMessage({isplaying:s.isplaying}))}),r.playpause.observe(document.querySelector("#player .playpause"),{attributes:!0,attributeFilter:["class"]}),r.songinfo=new MutationObserver(function(){var e={};e.song=l.song(!0),e.artist=l.artist(!0),e.album=l.album(!0),e.albumart=l.albumart(!0),e.playlist=l.playlist(!0),e.playlists=l.playlists(!0),e.songvote=l.songvote(!0),e.elapsedTime=l.elapsedtime(!0),e.totalTime=l.totaltime(!0),i.postMessage(e)}),r.songinfo.observe(document.querySelector("#player .fullwidth"),{subtree:!0,characterData:!0,childList:!0}),r.albumart=new MutationObserver(function(){void 0!==l.albumart(!0)&&i.postMessage({albumart:s.albumart})}),r.albumart.observe(document.querySelector("#player .art"),{subtree:!0,childList:!0,attributes:!0,attributeFilter:["src"]}),r.songvote=new MutationObserver(function(){void 0!==l.songvote(!0)&&i.postMessage({songvote:s.songvote})}),r.songvote.observe(document.querySelector("#player .adjust"),{subtree:!0,attributes:!0,attributeFilter:["class"]}),r.volume=new MutationObserver(function(){void 0!==l.volume(!0)&&i.postMessage({volume:s.volume})}),r.volume.observe(document.querySelector("#player .volume"),{subtree:!0,attributes:!0,attributeFilter:["style"]})},m=function(){setTimeout(function(){void 0!==l.playlists(!0)&&i.postMessage({playlists:s.playlists})},1e3)},v=function(){var e=window.history.pushState.bind(window.history);window.history.pushState=function(t,n,o){e(t,n,o);var a=document.createEvent("Event");a.initEvent("pushstate",!0,!0,window),window.dispatchEvent(a)}},y=document.createElement("script");y.id="pushstateevent",y.innerText="if(!window.pushstateeventflag)("+v.toString()+")();window.pushstateeventflag=true;document.body.removeChild(document.querySelector('#"+y.id+"'));",document.body.appendChild(y);var f=function(){if(i)try{i.disconnect()}catch(e){}i=null,runningslacker=void 0,window.removeEventListener("pushstate",m,!0),window.removeEventListener("popstate",m,!0);for(var t in r)r[t].disconnect();chrome.storage.onChanged.removeListener(o)},g=function(e){"play"==e.action&&u.play(),"pause"==e.action&&u.pause(),"forcepaused"==e.action&&u.forcepaused(),"prev"==e.action&&u.prev(),"next"==e.action&&u.next(),"thumbup"==e.action&&u.songvote(1),"thumbdown"==e.action&&u.songvote(-1),"songvote"==e.action&&u.songvote(e.songvote),"setvolume"==e.action&&u.volume(e.volume),"seek"==e.action&&u.seek(e.seek),"setplaylist"==e.action&&u.playlist(e.playlist),"togglerepeat"==e.action&&u.moderepeat(!l.moderepeat()),"toggleshuffle"==e.action&&u.modeshuffle(!l.modeshuffle())},b=function(){var e=function(){return document.querySelector("#player:not(.collapse) .playpause")?void d():setTimeout(e,500)};setTimeout(e,10)}}()}