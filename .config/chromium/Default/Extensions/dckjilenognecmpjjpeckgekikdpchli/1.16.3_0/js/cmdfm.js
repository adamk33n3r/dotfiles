if("undefined"==typeof runningcmdfm){var runningcmdfm=!0,exports={};!function(){var e={},n={},t=2;chrome.storage.local.get(null,function(n){e=n,0==--t&&x()}),chrome.storage.sync.get(null,function(e){if(n=e,!n.test)for(var i in console)console[i]=function(){};0==--t&&x()});var i=function(t,i){if("local"==i)for(var o in t)e[o]=t[o].newValue;else if("sync"==i)for(var o in t)n[o]=t[o].newValue};chrome.storage.onChanged.addListener(i);var o=function(e){var n=document.createElement("script");n.id=Math.floor(Math.random()*Math.pow(2,30)).toString(32),n.innerText='window.terminal.engine("'+e+'");document.head.removeChild(document.getElementById("'+n.id+'"));',document.head.appendChild(n)},r=function(){return[]};window.MutationObserver=window.MutationObserver||window.WebkitMutationObserver;var a={},l=null,c=null,u=null,s=null,d=null,m=-1,p=null,v=null,g=null,f={},h=function(){if(!v){l=!1,c=document.querySelector(".terminal-output > div:nth-child(1) > div"),c=c&&c.innerText.match(/^Playing:/)?c.innerText.replace(/^Playing:/,"").trim():"";var e="",n="";d="",u=0,s=100;var t=null;v=chrome.extension.connect({name:JSON.stringify({name:"playerport",type:"cmdfm",isplaying:l,song:c,artist:e,album:n,albumart:d,songvote:u,volume:s,playlists:r(),playlist:t})}),v.onMessage.addListener(w),v.onDisconnect.addListener(y),a={},a.commands=new MutationObserver(function(){var e=!1,n={},t=document.querySelector(".terminal-output > div:nth-child(2) > div");t=t&&t.innerText.match(/^Status:/)?t.innerText.match(/^Status:\D*(\d+):(\d+)\D+(\d+):(\d+)/):["","0","0","0","0"];var i=60*parseInt(t[1])+parseInt(t[2]),o=60*parseInt(t[3])+parseInt(t[4]);i!=f.elapsed&&(f.elapsed=i,f.totaltime=o,e=!0,n.elapsedTime=i,n.totalTime=o,l||(l=!0,n.isplaying=!0));var r=document.querySelector(".terminal-output > div:nth-child(1) > div");r=r&&r.innerText.match(/^Playing:/)?r.innerText.replace(/^Playing:/,"").trim():"",r!=c&&(c=r,e=!0,n.song=c);var a=document.querySelectorAll(".console");(a.length<=m||a[m]!=p)&&(m=-1,p=null);for(var u=m+1;u<a.length;u++)a[u].innerText.match(/Player.*paused/)&&l&&(l=!1,e=!0,n.isplaying=!1,setTimeout(function(){l=!1,v.postMessage({isplaying:!1})},1e3));m=a.length-1,p=a[m],e&&v.postMessage(n)}),a.commands.observe(document.querySelector(".terminal-output"),{subtree:!0,childList:!0,characterData:!0})}},y=function(){v&&v.disconnect(),v=null,runningcmdfm=void 0;for(var e in a)a[e].disconnect();chrome.storage.onChanged.removeListener(i)},w=function(e){e.pong&&(g=!0),"play"==e.action&&o("resume"),"pause"==e.action&&o("pause"),"prev"==e.action&&o("back"),"next"==e.action&&o("next")},x=function(){var e=function(){return document.querySelector(".cmd .clipboard")?void h():setTimeout(e,500)};e()}}()}