if("undefined"==typeof runningrdio){var runningrdio=!0,exports={};!function(){var e={},t={},o=2;chrome.storage.local.get(null,function(t){e=t,0==--o&&v()}),chrome.storage.sync.get(null,function(e){if(t=e,!t.test)for(var n in console)console[n]=function(){};0==--o&&v()});var n=function(o,n){if("local"==n)for(var r in o)e[r]=o[r].newValue;else if("sync"==n)for(var r in o)t[r]=o[r].newValue};chrome.storage.onChanged.addListener(n);var r=function(e,t,o){if(e){t=t||0,o=o||0;var n=document.createEvent("MouseEvents");n.initMouseEvent("mousedown",!0,!0,window,1,0,0,t,o,!1,!1,!1,!1,0,null),e.dispatchEvent(n),n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,window,1,0,0,t,o,!1,!1,!1,!1,0,null),e.dispatchEvent(n),n=document.createEvent("MouseEvents"),n.initMouseEvent("mouseup",!0,!0,window,1,0,0,t,o,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}};window.MutationObserver=window.MutationObserver||window.WebkitMutationObserver;var a={},i=null,l={},u={},s={},c=!1,d=function(e,t,o){return o&&t===l[e]?void 0:l[e]=t};u.isplaying=function(e){return d("isplaying",!!document.querySelector(".left_controls .play_pause.playing"),e)},u.song=function(e){var t=document.querySelector(".player_bottom .song_title");return d("song",!u.adwatch()&&t?t.innerText:"",e)},u.artist=function(e){var t=document.querySelector(".player_bottom .artist_title");return d("artist",!u.adwatch()&&t?t.innerText:"",e)},u.album=function(e){document.querySelector(".details .metadata .album");return d("album","",e)},u.albumart=function(e){var t=document.querySelector(".right_controls .queue_art");return d("albumart",!u.adwatch()&&t?t.src.replace(/200\.jpg$/,"600.jpg"):"",e)},u.songvote=function(e){return d("songvote",0,e)},u.volume=function(e){var t=document.querySelector(".right_controls .volume .bar").style.width;if(""==t){var o=document.querySelector(".right_controls .volume"),n=o.style.visibility,r=o.style.width;o.style.visbility="visible",o.style.width="100%",setTimeout(function(){o.style.visibility=n,o.style.width=r},300),t=1}else t=parseInt(t.style.width)/100;return d("volume",t,e)},u.playlists=function(e){return d("playlists",[],e)},u.playlist=function(e){return d("playlist","",e)},u.elapsedtime=function(e){var t=document.querySelector(".player_bottom .time");return t=t?t.innerText.match(/^(\d?\d):(\d\d)$/):void 0,t=t?60*t[1]+1*t[2]:void 0,d("elapsedtime",t,e)},u.totaltime=function(e){var t=document.querySelector(".player_bottom .duration");return t=t?t.innerText.match(/^(\d?\d):(\d\d)$/):void 0,t=t?60*t[1]+1*t[2]:void 0,d("totaltime",t,e)},u.moderepeat=function(e){return d("moderepeat",document.querySelector(".player_bottom .repeat.on")?"on":document.querySelector(".player_bottom .repeat.one")?"one":!1,e)},u.modeshuffle=function(e){return d("modeshuffle",!!document.querySelector(".player_bottom .shuffle.on"),e)},u.adwatch=function(e){return d("adwatch",!!document.querySelector(".App_PlayerFooter_Ad .player_bottom"),e)},s.play=function(){c=!1,r(document.querySelector(".left_controls .play_pause"))},s.pause=function(){r(document.querySelector(".left_controls .play_pause.playing"))},s.forcepaused=function(){c=!0,s.pause();var e=function(){c=!1,document.querySelector(".left_controls .play_pause").removeEventListener("click",e,!0),document.querySelector(".left_controls .prev").removeEventListener("click",e,!0),document.querySelector(".left_controls .next").removeEventListener("click",e,!0)};document.querySelector(".left_controls .play_pause").addEventListener("click",e,!0),document.querySelector(".left_controls .prev").addEventListener("click",e,!0),document.querySelector(".left_controls .next").addEventListener("click",e,!0)},s.prev=function(){c=!1,r(document.querySelector(".left_controls .prev"))},s.next=function(){c=!1,r(document.querySelector(".left_controls .next"))},s.songvote=function(){},s.volume=function(e){var t=document.querySelector(".right_controls .volume"),o=t.style.visibility,n=t.style.width;t.style.visbility="visible",t.style.width="100%",setTimeout(function(){var a=document.querySelector(".right_controls .volume .track"),i=0,l=a;do i+=l.offsetLeft;while(l=l.offsetParent);var u=a.offsetWidth,s=12;i+=s/2+(u-s)*e,r(a,i,0),t.style.visibility=o,t.style.width=n},300)},s.seek=function(e){var t=document.querySelector(".player_bottom .progress .track"),o=0,n=t;do o+=n.offsetLeft;while(n=n.offsetParent);var a=t.offsetWidth,i=0;o+=i/2+(a-i)*e,r(t,o,0)},s.playlist=function(){},s.moderepeat=function(e){for(var t=0;e!=u.moderepeat()&&(1!=e||!l.moderepeat)&&t++<10;)r(document.querySelector(".player_bottom .repeat"))},s.modeshuffle=function(e){e!=u.modeshuffle()&&r(document.querySelector(".player_bottom .shuffle"))};var m=function(){console.log("]]connect-rdio"),i=chrome.extension.connect({name:JSON.stringify({name:"playerport",type:"rdio",isplaying:u.isplaying(),song:u.song(),artist:u.artist(),album:u.album(),albumart:u.albumart(),songvote:u.songvote(),volume:u.volume(),playlists:u.playlists(),playlist:u.playlist()})}),i.onMessage.addListener(p),i.onDisconnect.addListener(f),i._postMessage=i.postMessage,i.postMessage=function(){try{i._postMessage.apply(i,arguments)}catch(e){f()}},a={},a.playpause=new MutationObserver(function(){void 0!==u.isplaying(!0)&&(c&&l.isplaying?s.forcepaused():i.postMessage({isplaying:l.isplaying}))}),a.playpause.observe(document.querySelector(".left_controls .play_pause"),{attributes:!0,attributeFilter:["class"]}),a.songinfo=new MutationObserver(function(){var e={};e.song=u.song(!0),e.artist=u.artist(!0),e.album=u.album(!0),i.postMessage(e)}),a.songinfo.observe(document.querySelector(".player_bottom .text_metadata"),{subtree:!0,childList:!0,characterData:!0}),a.albumart=new MutationObserver(function(){void 0!==u.albumart(!0)&&i.postMessage({albumart:l.albumart})}),a.albumart.observe(document.querySelector(".right_controls .queue_art"),{attributes:!0,attributeFilter:["src"]}),a.volume=new MutationObserver(function(){void 0!==u.volume(!0)&&i.postMessage({volume:l.volume})}),a.volume.observe(document.querySelector(".right_controls .volume .bar"),{attributes:!0,attributeFilter:["style"]}),a.time=new MutationObserver(function(){void 0!==u.elapsedtime(!0)&&i.postMessage({elapsedTime:l.elapsedtime,totalTime:u.totaltime()})}),a.time.observe(document.querySelector(".player_bottom .time"),{subtree:!0,childList:!0,characterData:!0}),a.moderepeat=new MutationObserver(function(){i.postMessage({moderepeat:u.moderepeat()})}),a.moderepeat.observe(document.querySelector(".player_bottom .repeat"),{attributes:!0,attributeFilter:["class"]}),a.modeshuffle=new MutationObserver(function(){i.postMessage({modeshuffle:u.modeshuffle()})}),a.modeshuffle.observe(document.querySelector(".player_bottom .shuffle"),{attributes:!0,attributeFilter:["class"]}),a.adwatch=new MutationObserver(function(){if(void 0!==u.adwatch(!0)){var e={};e.song=u.song(!0),e.artist=u.artist(!0),e.album=u.album(!0),e.albumart=u.albumart(!0),i.postMessage(e)}}),a.adwatch.observe(document.querySelector(".App_PlayerFooter_Ad"),{childList:!0})},f=function(){if(i)try{i.disconnect()}catch(e){}i=null,runningrdio=void 0;for(var t in a)a[t].disconnect();chrome.storage.onChanged.removeListener(n)},p=function(e){"play"==e.action&&s.play(),"pause"==e.action&&s.pause(),"forcepaused"==e.action&&s.forcepaused(),"prev"==e.action&&s.prev(),"next"==e.action&&s.next(),"thumbup"==e.action&&s.songvote(1),"thumbdown"==e.action&&s.songvote(-1),"setvolume"==e.action&&s.volume(e.volume),"seek"==e.action&&s.seek(e.seek),"setplaylist"==e.action&&s.playlist(e.playlist),"togglerepeat"==e.action&&s.moderepeat(!u.moderepeat()),"toggleshuffle"==e.action&&s.modeshuffle(!u.modeshuffle())},v=function(){var e=function(){return document.querySelector(".left_controls .play_pause")?void m():setTimeout(e,500)};setTimeout(e,10)}}()}