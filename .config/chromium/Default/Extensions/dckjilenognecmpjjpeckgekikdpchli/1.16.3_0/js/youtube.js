if("undefined"==typeof runningyoutube){var runningyoutube=!0,exportsyoutube={};!function(){var e={},t={},n=2;chrome.storage.local.get(null,function(t){e=t,0==--n&&L()}),chrome.storage.sync.get(null,function(e){if(t=e,!t.test)for(var o in console)console[o]=function(){};0==--n&&L()});var o=function(n,o){if("local"==o)for(var i in n)e[i]=n[i].newValue;else if("sync"==o)for(var i in n)t[i]=n[i].newValue};chrome.storage.onChanged.addListener(o);var i=function(e,t,n){t=t||0,n=n||0;var o=document.createEvent("MouseEvents");o.initMouseEvent("mousedown",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("click",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("mouseup",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o)},a=function(e){if(e.constructor!==HTMLVideoElement)return null;var t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight;var n=t.getContext("2d");return n.drawImage(e,0,0,t.width,t.height),t.toDataURL("image/png")},u=function(e){return e==s?!0:(e.paused||r({elem:e}),!1)},r=function(e){l=document.querySelectorAll("video, embed");var t=null;if("elem"in e)for(var n=0;n<l.length;n++)if(l[n]==e.elem){t=n;break}"index"in e&&(t=e.index),null!==t&&l[t]&&l[t]!=s&&(console.log("set",t),g.pause(),s=l[t],c=t,g.play(),d.postMessage({isplaying:v.isplaying(),song:v.song(),artist:v.artist(),album:v.album(),albumart:v.albumart(),songvote:v.songvote(),volume:v.volume(),playlists:v.playlists(),playlist:v.playlist()}),clearInterval(E),s.constructor===HTMLEmbedElement&&(E=setInterval(M,1e3)))};window.MutationObserver=window.MutationObserver||window.WebkitMutationObserver;var l=[],s=null,c=null,m={},d=null,p={},v={},g={},f=!1,y=function(e,t,n){return n&&t===p[e]?void 0:p[e]=t};v.isplaying=function(e){return s.constructor===HTMLEmbedElement?y("isplaying",s.getPlayerState&&1==s.getPlayerState(),e):y("isplaying",!s.paused,e)},v.song=function(e){var t=document.querySelector("#eow-title, #builder-preview-title, .html5-title-text");return y("song",t?t.innerText:document.title.replace(" - YouTube",""),e)},v.artist=function(e){var t=document.querySelector("#watch7-user-header .yt-user-name, a.author, .qualified-channel-title a");return y("artist",t?t.innerText:"",e)},v.album=function(e){return y("album","",e)},v.albumart=function(e){var t=document.querySelector("span[itemprop=thumbnail] link[itemprop=url], .video-thumbnail");return t=t?t.href||t.style.backgroundImage.replace(/^url\((.*)\)$/,"$1"):null,t=t||s.poster||a(s)||"",y("albumart",t,e)},v.songvote=function(e){return y("songvote",0,e)},v.volume=function(e){return s.constructor===HTMLEmbedElement?y("volume",s.getVolume?s.getVolume()/100:1,e):y("volume",s.muted?0:s.volume,e)},v.playlists=function(e){for(var t=[],n=document.querySelectorAll(".playlist-video-description h4"),o=0;o<n.length;o++)t.push(n[o].innerText);return y("playlists",t,e)},v.playlist=function(e){var t=document.querySelector(".currently-playing .playlist-video-description h4");return y("playlist",t&&t.innerText||void 0,e)},v.elapsedtime=function(e){return s.constructor===HTMLEmbedElement?y("elapsedtime",s.getCurrentTime?s.getCurrentTime():0,e):y("elapsedtime",Math.round(s.currentTime),e)},v.totaltime=function(e){return s.constructor===HTMLEmbedElement?y("totaltime",s.getDuration?s.getDuration():1,e):y("totaltime",Math.round(s.duration),e)},v.moderepeat=function(e){return y("moderepeat",!1,e)},v.modeshuffle=function(e){return y("modeshuffle",!1,e)},v.adwatch=function(e){return y("adwatch",!1,e)},g.play=function(){if(f=!1,!v.isplaying()){if(s.constructor===HTMLEmbedElement)return s.playVideo&&s.playVideo();i(document.querySelector(".html5-video-container"))}},g.pause=function(){if(v.isplaying()){if(s.constructor===HTMLEmbedElement)return s.pauseVideo&&s.pauseVideo();s.pause()}},g.forcepaused=function(){f=!0,g.pause()},g.prev=function(){f=!1},g.next=function(){f=!1},g.songvote=function(){},g.volume=function(e){return s.constructor===HTMLEmbedElement?s.setVolume&&s.setVolume(100*e):(s.volume=e,void(s.muted=0==e))},g.playlist=function(e){for(var t=v.playlists(),n=0;n<t.length;n++)if(t[n]==e){var o=document.querySelectorAll(".playlist-video-description h4");return void i(o[n])}},g.moderepeat=function(){},g.modeshuffle=function(){};var h=function(){console.log("]] connect-youtube"),l=document.querySelectorAll("video, embed"),s=l[0],c=0,d=chrome.runtime.connect({name:JSON.stringify({name:"playerport",type:"youtube",isplaying:v.isplaying(),song:v.song(),artist:v.artist(),album:v.album(),albumart:v.albumart(),songvote:v.songvote(),volume:v.volume(),playlists:v.playlists(),playlist:v.playlist(),moderepeat:v.moderepeat(),modeshuffle:v.modeshuffle()})}),d.onMessage.addListener(w),d.onDisconnect.addListener(T),d._postMessage=d.postMessage,d.postMessage=function(){try{d._postMessage.apply(d,arguments)}catch(e){T()}};for(var e=0;e<l.length;e++)l[e].addEventListener("timeupdate",b.timeupdate,!0),l[e].addEventListener("playing",b.playing,!0),l[e].addEventListener("pause",b.pause,!0),l[e].addEventListener("volumechange",b.volumechange,!0);clearInterval(E),s.constructor===HTMLEmbedElement&&(E=setInterval(M,1e3)),m={},document.querySelector("#page-container")&&(m.songinfo=new MutationObserver(function(){void 0!==v.song(!0)&&setTimeout(function(){d.postMessage({song:v.song(),artist:v.artist(),album:v.album(),albumart:v.albumart(),playlist:v.playlist()})},500)}),m.songinfo.observe(document.querySelector("#page-container"),{subtree:!0,childList:!0,characterData:!0}))},b={};b.timeupdate=function(){u(this)&&void 0!==v.elapsedtime(!0)&&d.postMessage({elapsedTime:p.elapsedtime,totalTime:v.totaltime()})},b.playing=function(){r({elem:this}),u(this)&&void 0!==v.isplaying(!0)&&(f&&p.isplaying?g.forcepaused():d.postMessage({isplaying:p.isplaying}))},b.pause=function(){u(this)&&void 0!==v.isplaying(!0)&&d.postMessage({isplaying:p.isplaying})},b.volumechange=function(){u(this)&&void 0!==v.volume(!0)&&d.postMessage({volume:p.volume})};var E=null,M=function(){s.constructor===HTMLEmbedElement&&(void 0!==v.isplaying(!0)&&(f&&p.isplaying?g.forcepaused():d.postMessage({isplaying:p.isplaying})),void 0!==v.elapsedtime(!0)&&d.postMessage({elapsedTime:p.elapsedtime,totalTime:v.totaltime()}),void 0!==v.volume(!0)&&d.postMessage({volume:p.volume}))},T=function(){if(console.log("]] ondisconnect"),d)try{d.disconnect()}catch(e){}d=null,runningyoutube=void 0;for(var t in m)m[t].disconnect();for(var n=0;n<l.length;n++)l[n].removeEventListener("timeupdate",b.timeupdate,!0),l[n].removeEventListener("playing",b.playing,!0),l[n].removeEventListener("pause",b.pause,!0),l[n].removeEventListener("volumechange",b.volumechange,!0);clearInterval(E),chrome.storage.onChanged.removeListener(o)},w=function(e){"play"==e.action&&g.play(),"pause"==e.action&&g.pause(),"forcepaused"==e.action&&g.forcepaused(),"prev"==e.action&&g.prev(),"next"==e.action&&g.next(),"thumbup"==e.action&&g.songvote(1),"thumbdown"==e.action&&g.songvote(-1),"songvote"==e.action&&g.songvote(e.songvote),"setvolume"==e.action&&g.volume(e.volume),"setplaylist"==e.action&&g.playlist(e.playlist),"togglerepeat"==e.action&&g.moderepeat(!v.moderepeat()),"toggleshuffle"==e.action&&g.modeshuffle(!v.modeshuffle())},L=function(){if(!location.href.match(/^https?:\/\/([^\/]+\.)*youtube(-nocookie)?\.com\//))return void(runningyoutube=void 0);var e=function(){var t=document.querySelector("video, embed");return t?void h():setTimeout(e,1e3)};setTimeout(e,10)}}()}