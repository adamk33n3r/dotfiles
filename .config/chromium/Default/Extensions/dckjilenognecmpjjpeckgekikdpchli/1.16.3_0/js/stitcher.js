if("undefined"==typeof runningstitcher){var runningstitcher=!0,exports={};!function(){var e={},t={},o=2;chrome.storage.local.get(null,function(t){e=t,0==--o&&v()}),chrome.storage.sync.get(null,function(e){if(t=e,!t.test)for(var n in console)console[n]=function(){};0==--o&&v()});var n=function(o,n){if("local"==n)for(var r in o)e[r]=o[r].newValue;else if("sync"==n)for(var r in o)t[r]=o[r].newValue};chrome.storage.onChanged.addListener(n);var r=function(e,t,o){if(e){t=t||0,o=o||0;var n=document.createEvent("MouseEvents");n.initMouseEvent("mousedown",!0,!0,window,1,0,0,t,o,!1,!1,!1,!1,0,null),e.dispatchEvent(n),n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,window,1,0,0,t,o,!1,!1,!1,!1,0,null),e.dispatchEvent(n),n=document.createEvent("MouseEvents"),n.initMouseEvent("mouseup",!0,!0,window,1,0,0,t,o,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}};window.MutationObserver=window.MutationObserver||window.WebkitMutationObserver;var i={},a=null,u={},l={},s={},c=!1,d=function(e,t,o){return o&&t===u[e]?void 0:u[e]=t};l.isplaying=function(e){return d("isplaying",!!document.querySelector("#audio_content .playing"),e)},l.song=function(e){var t=document.querySelector(".current-playlist-playing span strong");return d("song",t?t.innerText:"",e)},l.artist=function(e){var t=document.querySelector(".current-playlist-playing span dfn");return d("artist",t?t.innerText:"",e)},l.album=function(e){return d("album","",e)},l.albumart=function(e){var t=document.querySelector(".current-playlist-playing img");return d("albumart",t?t.src:"",e)},l.songvote=function(e){return d("songvote",document.querySelector("#audio_player-thumbsup.liked")?1:document.querySelector("#audio_player-thumbsdown.disliked")?-1:0,e)},l.volume=function(e){var t=parseInt(document.querySelector("#volume_control .ui-slider-handle").style.bottom)/100;return d("volume",t,e)},l.playlists=function(e){for(var t=document.querySelectorAll(".current-playlist-list-item.upcoming"),o=[],n=0;n<t.length;n++)o.push(t[n].querySelector("strong").innerText);return d("playlists",o,e)},l.playlist=function(e){return d("playlist",l.song(),e)},l.elapsedtime=function(e){var t=document.querySelector("#audio_player-time");return t=t?t.innerText.match(/^(\d*\d):(\d\d)$/):void 0,t=t?60*t[1]+1*t[2]:void 0,d("elapsedtime",t,e)},l.totaltime=function(e){var t=document.querySelector("#audio_player-duration");return t=t?t.innerText.match(/^(\d*\d):(\d\d)$/):void 0,t=t?60*t[1]+1*t[2]:void 0,d("totaltime",t,e)},l.moderepeat=function(e){return d("moderepeat",!1,e)},l.modeshuffle=function(e){return d("modeshuffle",!1,e)},l.adwatch=function(e){return d("adwatch",!1,e)},s.play=function(){c=!1,r(document.querySelector("#audio_player-play"))},s.pause=function(){r(document.querySelector("#audio_content .playing #audio_player-play"))},s.forcepaused=function(){c=!0,s.pause();var e=function(){c=!1,document.querySelector("#audio_player-play").removeEventListener("click",e,!0),document.querySelector("#audio_player-skip").removeEventListener("click",e,!0)};document.querySelector("#audio_player-play").addEventListener("click",e,!0),document.querySelector("#audio_player-skip").addEventListener("click",e,!0)},s.prev=function(){c=!1},s.next=function(){c=!1,r(document.querySelector("#audio_player-skip"))},s.songvote=function(e){1==e&&r(document.querySelector("#audio_player-thumbsup")),-1==e&&r(document.querySelector("#audio_player-thumbsdown"))},s.volume=function(e){var t=document.querySelector("#volume_control"),o=0,n=t;do o+=n.offsetTop;while(n=n.offsetParent);var i=t.offsetHeight,a=0;o+=a/2+(i-a)*(1-e),r(t,0,o)},s.seek=function(e){var t=document.querySelector("#audio_player-seekbar"),o=0,n=t;do o+=n.offsetLeft;while(n=n.offsetParent);var i=t.offsetWidth,a=0;o+=a/2+(i-a)*e,r(t,o,0)},s.playlist=function(e){for(var t=document.querySelectorAll(".current-playlist-list-item.upcoming"),o=0;o<t.length;o++)if(t[o].querySelector("strong").innerText==e)return r(t[o]),void setTimeout(function(){r(document.querySelector("#modal_wrapper .episode-play-button")),r(document.querySelector("#modal_wrapper .stitcher-modal-close"))},1500)},s.moderepeat=function(){},s.modeshuffle=function(){};var p=function(){console.log("]]connect-stitcher"),a=chrome.extension.connect({name:JSON.stringify({name:"playerport",type:"stitcher",isplaying:l.isplaying(),song:l.song(),artist:l.artist(),album:l.album(),albumart:l.albumart(),songvote:l.songvote(),volume:l.volume(),playlists:l.playlists(),playlist:l.playlist()})}),a.onMessage.addListener(y),a.onDisconnect.addListener(m),a._postMessage=a.postMessage,a.postMessage=function(){try{a._postMessage.apply(a,arguments)}catch(e){m()}},i={},i.playpause=new MutationObserver(function(){void 0!==l.isplaying(!0)&&(c&&u.isplaying?s.forcepaused():a.postMessage({isplaying:u.isplaying}))}),i.playpause.observe(document.querySelector("#audio_content > :first-child"),{attributes:!0,attributeFilter:["class"]}),i.songinfo=new MutationObserver(function(){var e={};e.song=l.song(!0),e.artist=l.artist(!0),e.album=l.album(!0),e.albumart=l.albumart(!0),e.playlist=l.playlist(!0),e.playlists=l.playlists(!0),a.postMessage(e)}),i.songinfo.observe(document.querySelector("#current-playlist"),{subtree:!0,childList:!0,characterData:!0,attributes:!0,attributeFilter:["class"]}),i.volume=new MutationObserver(function(){void 0!==l.volume(!0)&&a.postMessage({volume:u.volume})}),i.volume.observe(document.querySelector("#volume_control .ui-slider-handle"),{attributes:!0,attributeFilter:["style"]}),i.songvote=new MutationObserver(function(){void 0!==l.songvote(!0)&&a.postMessage({songvote:u.songvote})}),i.songvote.observe(document.querySelector("#player-playback-controls-wrapper"),{subtree:!0,childList:!0,attributes:!0,attributeFilter:["class"]}),i.time=new MutationObserver(function(){void 0!==l.elapsedtime(!0)&&a.postMessage({elapsedTime:u.elapsedtime,totalTime:l.totaltime()})}),i.time.observe(document.querySelector("#audio_player-time"),{subtree:!0,childList:!0,characterData:!0})},m=function(){if(a)try{a.disconnect()}catch(e){}a=null,runningstitcher=void 0;for(var t in i)i[t].disconnect();chrome.storage.onChanged.removeListener(n)},y=function(e){"play"==e.action&&s.play(),"pause"==e.action&&s.pause(),"forcepaused"==e.action&&s.forcepaused(),"prev"==e.action&&s.prev(),"next"==e.action&&s.next(),"thumbup"==e.action&&s.songvote(1),"thumbdown"==e.action&&s.songvote(-1),"setvolume"==e.action&&s.volume(e.volume),"seek"==e.action&&s.seek(e.seek),"setplaylist"==e.action&&s.playlist(e.playlist),"togglerepeat"==e.action&&s.moderepeat(!l.moderepeat()),"toggleshuffle"==e.action&&s.modeshuffle(!l.modeshuffle())},v=function(){var e=function(){return document.querySelector("#audio_player-play")?void p():setTimeout(e,500)};setTimeout(e,10)}}()}