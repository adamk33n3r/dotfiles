if("undefined"==typeof runningdigitallyimported){var runningdigitallyimported=!0,exportsdigitallyimported={};!function(){console.log("digitallyimported");var e={},t={},n=2;chrome.storage.local.get(null,function(t){e=t,0==--n&&y()}),chrome.storage.sync.get(null,function(e){if(t=e,!t.test)for(var o in console)console[o]=function(){};0==--n&&y()});var o=function(n,o){if("local"==o)for(var i in n)e[i]=n[i].newValue;else if("sync"==o)for(var i in n)t[i]=n[i].newValue};chrome.storage.onChanged.addListener(o);var i=function(e,t,n){t=t||0,n=n||0;var o=document.createEvent("MouseEvents");o.initMouseEvent("mousedown",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("click",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("mouseup",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o)};window.MutationObserver=window.MutationObserver||window.WebkitMutationObserver;var r={},a=null,u={},l={},s={},c=!1,d=function(e,t,n){return n&&t===u[e]?void 0:u[e]=t};l.isplaying=function(e){return d("isplaying",!!document.querySelector("#ctl-play .icon-stop"),e)},l.song=function(e){var t=document.querySelector(".title-container"),n=t?t.innerText.match(/^([^-]+) - (.+)/):null;return d("song",n?n[1]:"",e)},l.artist=function(e){var t=document.querySelector(".title-container"),n=t?t.innerText.match(/^([^-]+) - (.+)/):null;return d("artist",n?n[2]:"",e)},l.album=function(e){return d("album","",e)},l.albumart=function(e){var t=document.querySelector("#art img");return d("albumart",t?t.src:"",e)},l.songvote=function(e){return d("songvote",0,e)},l.volume=function(e){return d("volume",parseInt(document.querySelector("#popup-volume .progress-bar").style.width)/100,e)},l.playlists=function(e){return d("playlists",[],e)},l.playlist=function(e){var t=document.querySelector("#channel-title");return d("playlist",t?t.innerText:"",e)},l.elapsedtime=function(e){var t=document.querySelector(".timestamps .elapsed"),n=t?t.innerText.match(/(\d?\d:)?(\d?\d):(\d\d)$/):null;return d("elapsedtime",n?60*parseInt(n[1]||0)*60+60*n[2]+1*n[3]:0,e)},l.totaltime=function(e){var t=document.querySelector(".timestamps .remaining"),n=t?t.innerText.match(/(\d?\d:)?(\d?\d):(\d\d)$/):null;return d("totaltime",n?60*parseInt(n[1]||0)*60+60*n[2]+1*n[3]+l.elapsedtime():1,e)},s.play=function(){c=!1,i(document.querySelector("#ctl-play .icon-play"))},s.pause=function(){i(document.querySelector("#ctl-play .icon-stop"))},s.forcepaused=function(){c=!0,i(document.querySelector("#ctl-play .icon-stop"));var e=function(){c=!1,document.querySelector("#ctl-play").removeEventListener("click",e,!0)};document.querySelector("#ctl-play").addEventListener("click",e,!0)},s.prev=function(){c=!1},s.next=function(){c=!1},s.songvote=function(){},s.volume=function(e){var t=document.querySelector("#popup-volume"),n=t.style.display;t.style.display="block";var o=document.querySelector("#popup-volume .progress-container"),i=0,r=o;do i+=r.offsetLeft;while(r=r.offsetParent);i+=4+Math.round((o.offsetWidth-2)*e);var a=document.createEvent("MouseEvents");a.initMouseEvent("mousedown",!0,!0,window,1,0,0,i,0,!1,!1,!1,!1,0,null),o.dispatchEvent(a);var a=document.createEvent("MouseEvents");a.initMouseEvent("mouseup",!0,!0,window,1,0,0,i,0,!1,!1,!1,!1,0,null),o.dispatchEvent(a);var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,1,0,0,i,0,!1,!1,!1,!1,0,null),o.dispatchEvent(a),t.style.display=n},s.playlist=function(){};var p=function(){console.log("]] connect-di.fm"),a=chrome.runtime.connect({name:JSON.stringify({name:"playerport",type:"digitallyimported",isplaying:l.isplaying(),song:l.song(),artist:l.artist(),album:l.album(),albumart:l.albumart(),songvote:l.songvote(),volume:l.volume(),playlists:l.playlists(),playlist:l.playlist()})}),a.onMessage.addListener(v),a.onDisconnect.addListener(m),a._postMessage=a.postMessage,a.postMessage=function(){try{a._postMessage.apply(a,arguments)}catch(e){m()}},r={},r.playpause=new MutationObserver(function(){void 0!==l.isplaying(!0)&&(c&&u.isplaying?s.forcepaused():a.postMessage({isplaying:u.isplaying}))}),r.playpause.observe(document.querySelector("#ctl-play"),{subtree:!0,attributes:!0,attributeFilter:["class"]}),r.volume=new MutationObserver(function(){void 0!==l.volume(!0)&&a.postMessage({volume:u.volume})}),r.volume.observe(document.querySelector("#popup-volume .progress-bar"),{attributes:!0,attributeFilter:["style"]}),r.songinfo=new MutationObserver(function(){var e={};e.song=l.song(!0),e.artist=l.artist(!0),e.album=l.album(!0),a.postMessage(e)}),r.songinfo.observe(document.querySelector(".title-container"),{subtree:!0,childList:!0,characterData:!0}),r.albumart=new MutationObserver(function(){void 0!==l.albumart(!0)&&a.postMessage({albumart:u.albumart})}),r.albumart.observe(document.querySelector("#art img"),{attributes:!0,attributeFilter:["src"]}),r.time=new MutationObserver(function(){a.postMessage({elapsedTime:l.elapsedtime(),totalTime:l.totaltime()})}),r.time.observe(document.querySelector("#now-playing"),{subtree:!0,childList:!0})},m=function(){if(console.log("]] ondisconnect"),a)try{a.disconnect()}catch(e){}a=null,runningdigitallyimported=void 0;for(var t in r)r[t].disconnect();chrome.storage.onChanged.removeListener(o)},v=function(e){"play"==e.action&&s.play(),"pause"==e.action&&s.pause(),"forcepaused"==e.action&&s.forcepaused(),"prev"==e.action&&s.prev(),"next"==e.action&&s.next(),"thumbup"==e.action&&s.songvote(1),"thumbdown"==e.action&&s.songvote(-1),"setvolume"==e.action&&s.volume(e.volume),"setplaylist"==e.action&&s.playlist(e.playlist)},y=function(){var e=function(){return document.querySelector("#ctl-play")?void p():setTimeout(e,500)};setTimeout(e,10)}}()}