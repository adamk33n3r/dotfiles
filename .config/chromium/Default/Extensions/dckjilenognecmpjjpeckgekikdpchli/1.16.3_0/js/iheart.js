if("undefined"==typeof runningiheart){var runningiheart=!0,exports={};!function(){var e={},t={},n=2;chrome.storage.local.get(null,function(t){e=t,0==--n&&y()}),chrome.storage.sync.get(null,function(e){if(t=e,!t.test)for(var o in console)console[o]=function(){};0==--n&&y()});var o=function(n,o){if("local"==o)for(var r in n)e[r]=n[r].newValue;else if("sync"==o)for(var r in n)t[r]=n[r].newValue};chrome.storage.onChanged.addListener(o);var r=function(e,t,n){if(e){t=t||0,n=n||0;var o=document.createEvent("MouseEvents");o.initMouseEvent("mousedown",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("click",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("mouseup",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o)}};window.MutationObserver=window.MutationObserver||window.WebkitMutationObserver;var i={},a=null,s={},u={},l={},c=!1,d=function(e,t,n){return n&&t===s[e]?void 0:s[e]=t};u.isplaying=function(e){return d("isplaying",!!document.querySelector("#header-controls .js-play.pause"),e)},u.song=function(e){var t=document.querySelector(".js-track-name");return d("song",t?t.innerText.replace(/\s/g," ").trim():"",e)},u.artist=function(e){var t=document.querySelector(".js-artist-name");return d("artist",t?t.innerText.replace(/\s/g," ").trim():"",e)},u.album=function(e){return d("album","",e)},u.albumart=function(e){var t=document.querySelector(".js-song-art");return t=t?t.style.backgroundImage.match(/url\((.+)\)/):void 0,d("albumart",t?t[1].replace(/\?w=50&h=50/,"?w=250&h=250"):"",e)},u.songvote=function(e){return d("songvote",document.querySelector(".js-thumbs-up.active")?1:document.querySelector(".js-thumbs-down.active")?-1:0,e)},u.volume=function(e){var t=document.querySelector(".header-volume-slider .ui-slider-range");return d("volume",t?1-parseFloat(t.style.height)/100:1,e)},u.playlists=function(e){var t=[];return d("playlists",t,e)},u.playlist=function(e){var t=document.querySelector(".js-station-name");return d("playlist",t?t.innerText.replace(/\s/g," ").trim():"",e)},u.elapsedtime=function(e){var t=document.querySelector(".js-duration");return t=t?t.innerText.trim().match(/^(\d*\d):(\d\d) /):void 0,t=t?60*t[1]+1*t[2]:void 0,d("elapsedtime",t,e)},u.totaltime=function(e){var t=document.querySelector(".js-duration");return t=t?t.innerText.trim().match(/ (\d*\d):(\d\d)$/):void 0,t=t?60*t[1]+1*t[2]:void 0,d("totaltime",t,e)},u.moderepeat=function(e){return d("moderepeat",!1,e)},u.modeshuffle=function(e){return d("modeshuffle",!1,e)},u.adwatch=function(e){return d("adwatch",!1,e)},l.play=function(){c=!1,r(document.querySelector("#header-controls .js-play:not(.pause)"))},l.pause=function(){r(document.querySelector("#header-controls .js-play.pause"))},l.forcepaused=function(){c=!0,l.pause();var e=function(){c=!1,document.querySelector(".js-play").removeEventListener("click",e,!0),document.querySelector(".js-next").removeEventListener("click",e,!0)};document.querySelector(".js-play").addEventListener("click",e,!0),document.querySelector(".js-next").addEventListener("click",e,!0)},l.prev=function(){c=!1},l.next=function(){c=!1,r(document.querySelector(".js-next"))},l.songvote=function(e){1==e&&r(document.querySelector(".js-thumbs-up")),-1==e&&r(document.querySelector(".js-thumbs-down"))},l.volume=function(e){var t=document.querySelector(".header-volume-dropdown"),n=t.style.visibility,o=t.style.opacity;t.style.visibility="visible";var i=document.querySelector(".header-volume-dropdown-bg"),a=0,s=i;do a+=s.offsetTop;while(s=s.offsetParent);a-=55,i.offsetHeight>10&&(a+=i.offsetHeight*(1-e),r(i,0,a)),t.style.visibility=n,t.style.opacity=o},l.seek=function(){},l.playlist=function(){},l.moderepeat=function(){},l.modeshuffle=function(){};var m=function(){console.log("]]connect-iheart"),a=chrome.extension.connect({name:JSON.stringify({name:"playerport",type:"iheart",isplaying:u.isplaying(),song:u.song(),artist:u.artist(),album:u.album(),albumart:u.albumart(),songvote:u.songvote(),volume:u.volume(),playlists:u.playlists(),playlist:u.playlist()})}),a.onMessage.addListener(p),a.onDisconnect.addListener(v),a._postMessage=a.postMessage,a.postMessage=function(){try{a._postMessage.apply(a,arguments)}catch(e){v()}},i={},i.playpause=new MutationObserver(function(){void 0!==u.isplaying(!0)&&(c&&s.isplaying?l.forcepaused():a.postMessage({isplaying:s.isplaying}))}),i.playpause.observe(document.querySelector("#header-controls .js-play"),{attributes:!0,attributeFilter:["class"]}),i.songinfo=new MutationObserver(function(){var e={};e.song=u.song(!0),e.artist=u.artist(!0),e.album=u.album(!0),e.albumart=u.albumart(!0),e.playlist=u.playlist(!0),e.playlists=u.playlists(!0),e.elapsedTime=u.elapsedtime(!0),e.totalTime=u.totaltime(!0),e.songvote=u.songvote(!0),a.postMessage(e)}),i.songinfo.observe(document.querySelector("#header-controls-song"),{subtree:!0,characterData:!0,childList:!0}),i.volume=new MutationObserver(function(){void 0!==u.volume(!0)&&a.postMessage({volume:s.volume})}),i.volume.observe(document.querySelector(".header-volume-slider .ui-slider-range"),{attributes:!0,attributeFilter:["style"]})},v=function(){if(a)try{a.disconnect()}catch(e){}a=null,runningiheart=void 0;for(var t in i)i[t].disconnect();chrome.storage.onChanged.removeListener(o)},p=function(e){"play"==e.action&&l.play(),"pause"==e.action&&l.pause(),"forcepaused"==e.action&&l.forcepaused(),"prev"==e.action&&l.prev(),"next"==e.action&&l.next(),"thumbup"==e.action&&l.songvote(1),"thumbdown"==e.action&&l.songvote(-1),"setvolume"==e.action&&l.volume(e.volume),"seek"==e.action&&l.seek(e.seek),"setplaylist"==e.action&&l.playlist(e.playlist),"togglerepeat"==e.action&&l.moderepeat(!u.moderepeat()),"toggleshuffle"==e.action&&l.modeshuffle(!u.modeshuffle())},y=function(){var e=function(){return document.querySelector("#header-controls .js-play")?void m():setTimeout(e,500)};setTimeout(e,10)}}()}