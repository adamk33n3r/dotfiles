if("undefined"==typeof runninggrooveshark){var runninggrooveshark=!0,exportsgrooveshark={};!function(){var e={},t={},n=2;chrome.storage.local.get(null,function(t){e=t,0==--n&&f()}),chrome.storage.sync.get(null,function(e){if(t=e,!t.test)for(var o in console)console[o]=function(){};0==--n&&f()});var o=function(n,o){if("local"==o)for(var r in n)e[r]=n[r].newValue;else if("sync"==o)for(var r in n)t[r]=n[r].newValue};chrome.storage.onChanged.addListener(o);var r=function(e){if(e){var t=document.createEvent("MouseEvents");t.initMouseEvent("mousedown",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t);var t=document.createEvent("MouseEvents");t.initMouseEvent("mouseup",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t);var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}},a=function(){return[]};window.MutationObserver=window.MutationObserver||window.WebkitMutationObserver;var u={},l=null,i=null,s=null,c=null,d=null,v={},p=!1,y=function(){if(!c){l=!!document.querySelector("#play-pause.playing");var e=document.querySelector("a.now-playing-link.song");e=e?e.innerText:"";var t=document.querySelector("a.now-playing-link.artist");t=t?t.innerText:"";var n=document.querySelector("a.now-playing-link.album");n=n?n.innerText:"";var o=document.querySelector("#now-playing-image");o=o?o.src.replace("/40_","/200_"):"",i=0,s=parseInt(document.querySelector("#volume-slider .ui-slider-range").style.height)/100;var d=null;d=d?d.innerText:"",c=chrome.extension.connect({name:JSON.stringify({name:"playerport",type:"grooveshark",isplaying:l,song:e,artist:t,album:n,albumart:o,songvote:i,volume:s,playlists:a(),playlist:d})}),c.onMessage.addListener(g),c.onDisconnect.addListener(m),u={},u.playpause=new MutationObserver(function(){var e=!!document.querySelector("#play-pause.playing");e!=l&&(p&&e&&r(document.querySelector("#play-pause.playing")),l=e,c.postMessage({isplaying:l}))}),u.playpause.observe(document.querySelector("#play-pause"),{attributes:!0,attributeFilter:["class"]}),u.volume=new MutationObserver(function(){var e=parseInt(document.querySelector("#volume-slider .ui-slider-range").style.height)/100;e!=s&&c.postMessage({volume:e}),s=e}),u.volume.observe(document.querySelector("#volume-slider .ui-slider-range"),{attributes:!0,attributeFilter:["style"]}),u.songinfo=new MutationObserver(function(){var e=document.querySelector("a.now-playing-link.song");e=e?e.innerText:"";var t=document.querySelector("a.now-playing-link.artist");t=t?t.innerText:"";var n=document.querySelector("a.now-playing-link.album");n=n?n.innerText:"",console.log({song:e,artist:t,album:n}),c.postMessage({song:e,artist:t,album:n})}),u.songinfo.observe(document.querySelector("#now-playing-metadata"),{subtree:!0,childList:!0}),u.albumart=new MutationObserver(function(){var e=document.querySelector("#now-playing-image");e=e?e.src.replace("/40_","/200_"):"",c.postMessage({albumart:e})}),u.albumart.observe(document.querySelector("#now-playing-image"),{attributes:!0,attributeFilter:["src"]}),u.elapsed=new MutationObserver(function(){var e=document.querySelector("#time-elapsed").innerText.match(/^(\d?\d):(\d\d)$/);e&&(v.elapsed=60*e[1]+1*e[2]);var e=document.querySelector("#time-total").innerText.match(/^(\d?\d):(\d\d)$/);e&&(v.duration=60*e[1]+1*e[2]),c.postMessage({elapsedTime:v.elapsed,totalTime:v.duration})}),u.elapsed.observe(document.querySelector("#now-playing"),{subtree:!0,childList:!0})}},m=function(){c&&c.disconnect(),c=null,runninggrooveshark=void 0;for(var e in u)u[e].disconnect();chrome.storage.onChanged.removeListener(o)},g=function(e){e.pong&&(d=!0);var t=document.querySelector("#player-wrapper");if(t&&"none"!=t.style.display){if("play"==e.action){p=!1,r(document.querySelector("#play-pause.paused"));var n=v.elapsed;setTimeout(function(){n==v.elapsed&&r(document.querySelector("#play-pause.paused"))},2e3)}if("initpause"==e.action){p=!0,r(document.querySelector("#play-pause.playing"));var o=10,a=setInterval(function(){!p||o--<=0?clearInterval(a):r(document.querySelector("#play-pause.playing"))},100),u=function(){p=!1,document.querySelector("#play-pause").removeEventListener("click",u,!0),document.querySelector("#play-next").removeEventListener("click",u,!0),document.querySelector("#play-prev").removeEventListener("click",u,!0)};document.querySelector("#play-pause").addEventListener("click",u,!0),document.querySelector("#play-next").addEventListener("click",u,!0),document.querySelector("#play-prev").addEventListener("click",u,!0)}if("pause"==e.action&&r(document.querySelector("#play-pause.playing")),"prev"==e.action&&r(document.querySelector("#play-prev")),"next"==e.action&&r(document.querySelector("#play-next")),"seek"==e.action){var l=document.querySelector("#progress-bar"),i=l.style.display;l.style.display="block";var s=0,c=l;do s+=c.offsetLeft;while(c=c.offsetParent);s+=0+Math.round(l.offsetWidth*e.seek);var y=document.createEvent("MouseEvents");y.initMouseEvent("mousedown",!0,!0,window,1,0,0,s,0,!1,!1,!1,!1,0,null),l.dispatchEvent(y);var y=document.createEvent("MouseEvents");y.initMouseEvent("mouseup",!0,!0,window,1,0,0,s,0,!1,!1,!1,!1,0,null),l.dispatchEvent(y);var y=document.createEvent("MouseEvents");y.initMouseEvent("click",!0,!0,window,1,0,0,s,0,!1,!1,!1,!1,0,null),l.dispatchEvent(y),l.style.display=i}if("setvolume"==e.action){var m=document.querySelector("#volume-control"),i=m.style.display;m.style.display="block";var l=document.querySelector("#volume-slider"),s=0,c=l;do s+=c.offsetTop;while(c=c.offsetParent);s+=2+Math.round(l.offsetHeight*(1-e.volume));var y=document.createEvent("MouseEvents");y.initMouseEvent("mousedown",!0,!0,window,1,0,0,0,s,!1,!1,!1,!1,0,null),l.dispatchEvent(y);var y=document.createEvent("MouseEvents");y.initMouseEvent("mouseup",!0,!0,window,1,0,0,0,s,!1,!1,!1,!1,0,null),l.dispatchEvent(y);var y=document.createEvent("MouseEvents");y.initMouseEvent("click",!0,!0,window,1,0,0,0,s,!1,!1,!1,!1,0,null),l.dispatchEvent(y),m.style.display=i}}},f=function(){var e=function(){return!document.querySelector("#play-pause")||document.querySelector("#play-pause.disabled")?setTimeout(e,500):void y()};e()}}()}