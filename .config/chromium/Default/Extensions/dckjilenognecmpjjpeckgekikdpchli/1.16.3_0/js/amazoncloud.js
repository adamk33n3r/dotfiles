if(console.log("amazon"),"undefined"==typeof runningamazoncloud){var runningamazoncloud=!0,exports={};!function(){var e={},t={},n=2;chrome.storage.local.get(null,function(t){e=t,0==--n&&f()}),chrome.storage.sync.get(null,function(e){if(t=e,!t.test)for(var o in console)console[o]=function(){};0==--n&&f()});var o=function(n,o){if("local"==o)for(var r in n)e[r]=n[r].newValue;else if("sync"==o)for(var r in n)t[r]=n[r].newValue};chrome.storage.onChanged.addListener(o);var r=function(e,t,n){if(e){t=t||0,n=n||0;var o=document.createEvent("MouseEvents");o.initMouseEvent("mousedown",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("click",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o),o=document.createEvent("MouseEvents"),o.initMouseEvent("mouseup",!0,!0,window,1,0,0,t,n,!1,!1,!1,!1,0,null),e.dispatchEvent(o)}};window.MutationObserver=window.MutationObserver||window.WebkitMutationObserver;var i={},a=null,u={},s={},l={},c=!1,d=function(e,t,n){return n&&t===u[e]?void 0:u[e]=t};s.isplaying=function(e){return d("isplaying",!!document.querySelector(".mp3MasterPlayGroup.playing"),e)},s.song=function(e){var t=document.querySelector(".currentSongDetails .title");return d("song",t?t.innerText.replace(/\s/g," ").trim():"",e)},s.artist=function(e){var t=document.querySelector(".currentSongAdditionalDetails > span:first-child");return d("artist",t?t.innerText.replace("&nbsp;"," ").trim().replace(/^by\s/,"").trim():"",e)},s.album=function(e){return d("album","",e)},s.albumart=function(e){var t=document.querySelector("#nowPlayingSection .albumImage");return d("albumart",t?t.src:"",e)},s.songvote=function(e){return d("songvote",0,e)},s.volume=function(e){var t=document.querySelector(".volumeContainer .ui-slider-range");return d("volume",t?parseFloat(t.style.width)/100:1,e)},s.playlists=function(e){var t=["All Songs"];try{for(var n=document.querySelectorAll("#smartPlaylists > li, #playlistSection > li"),o=0;o<n.length;o++)parseInt(n[o].querySelector(".entryCount").innerText)>0&&t.push(n[o].querySelector("a").innerText)}catch(r){}return d("playlists",t,e)},s.playlist=function(e){var t=document.querySelector("#smartPlaylists > li.viewing a, #playlistSection > li.viewing a");return t=t?t.innerText:document.querySelector("li.viewing #songsLink")?"All Songs":"",d("playlist",t,e)},s.elapsedtime=function(e){var t=document.querySelector("#currentTime");return t=t?t.innerText.trim().match(/^(\d*\d):(\d\d)$/):void 0,t=t?60*t[1]+1*t[2]:void 0,d("elapsedtime",t||0,e)},s.totaltime=function(e){var t=document.querySelector(".timer span:last-child");return t=t?t.innerText.trim().match(/^(\d*\d):(\d\d)$/):void 0,t=t?60*t[1]+1*t[2]:void 0,d("totaltime",t||1,e)},s.moderepeat=function(e){return d("moderepeat",!!document.querySelector(".repeatButton.repeated"),e)},s.modeshuffle=function(e){return d("modeshuffle",!!document.querySelector(".shuffleButton.shuffled"),e)},s.adwatch=function(e){return d("adwatch",!1,e)},l.play=function(){c=!1,r(document.querySelector(".mp3MasterPlayGroup.paused .mp3MasterPlay"))},l.pause=function(){r(document.querySelector(".mp3MasterPlayGroup.playing .mp3MasterPlay"))},l.forcepaused=function(){c=!0,l.pause();var e=function(){c=!1,document.querySelector(".mp3MasterPlay").removeEventListener("click",e,!0),document.querySelector(".mp3PlayNext").removeEventListener("click",e,!0),document.querySelector(".mp3PlayPrevious").removeEventListener("click",e,!0)};document.querySelector(".mp3MasterPlay").addEventListener("click",e,!0),document.querySelector(".mp3PlayNext").addEventListener("click",e,!0),document.querySelector(".mp3PlayPrevious").addEventListener("click",e,!0)},l.prev=function(){c=!1,r(document.querySelector(".mp3PlayPrevious"))},l.next=function(){c=!1,r(document.querySelector(".mp3PlayNext"))},l.songvote=function(e){},l.volume=function(e){var t=document.querySelector(".volumeContainer"),n=0,o=t;do n+=o.offsetLeft;while(o=o.offsetParent);if(t.offsetWidth>10){n+=t.offsetWidth*e;var r=document.createEvent("MouseEvents");r.initMouseEvent("mousedown",!0,!0,window,1,0,0,n,0,!1,!1,!1,!1,0,null),t.dispatchEvent(r);var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,1,0,0,n,0,!1,!1,!1,!1,0,null),t.dispatchEvent(r);var r=document.createEvent("MouseEvents");r.initMouseEvent("mouseup",!0,!0,window,1,0,0,n,0,!1,!1,!1,!1,0,null),t.dispatchEvent(r)}},l.seek=function(e){var t=document.querySelector("#scrubber"),n=0,o=t;do n+=o.offsetLeft;while(o=o.offsetParent);if(t.offsetWidth>10){n+=t.offsetWidth*e;var r=document.createEvent("MouseEvents");r.initMouseEvent("mousedown",!0,!0,window,1,0,0,n,0,!1,!1,!1,!1,0,null),t.dispatchEvent(r);var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,1,0,0,n,0,!1,!1,!1,!1,0,null),t.dispatchEvent(r);var r=document.createEvent("MouseEvents");r.initMouseEvent("mouseup",!0,!0,window,1,0,0,n,0,!1,!1,!1,!1,0,null),t.dispatchEvent(r)}},l.playlist=function(e){var t=null;if("All Songs"==e)e="Songs",t=document.querySelector("#songsLink");else for(var n=document.querySelectorAll("#smartPlaylists > li a, #playlistSection > li:not(:last-child) a"),o=0;o<n.length;o++)n[o].innerText==e&&(t=n[o]);if(t){r(t);var i=new MutationObserver(function(){var t=document.querySelector("#main-content-header .headerText");t&&t.innerText==e&&document.querySelector('#main-content-header a[href="#play/each"]')&&(r(document.querySelector('#main-content-header a[href="#play/each"]')),i.disconnect())});i.observe(document.querySelector("#center-content"),{subtree:!0,childList:!0})}},l.moderepeat=function(){r(document.querySelector(".repeatButton"))},l.modeshuffle=function(){r(document.querySelector(".shuffleButton"))};var m=function(){console.log("]]connect-amazoncloud"),a=chrome.extension.connect({name:JSON.stringify({name:"playerport",type:"amazoncloud",isplaying:s.isplaying(),song:s.song(),artist:s.artist(),album:s.album(),albumart:s.albumart(),songvote:s.songvote(),volume:s.volume(),playlists:s.playlists(),playlist:s.playlist()})}),a.onMessage.addListener(p),a.onDisconnect.addListener(v),a._postMessage=a.postMessage,a.postMessage=function(){try{a._postMessage.apply(a,arguments)}catch(e){v()}},i={},i.playpause=new MutationObserver(function(){void 0!==s.isplaying(!0)&&(c&&u.isplaying?l.forcepaused():a.postMessage({isplaying:u.isplaying}))}),i.playpause.observe(document.querySelector(".mp3MasterPlayGroup"),{attributes:!0,attributeFilter:["class"]}),i.songinfo=new MutationObserver(function(){var e={};e.song=s.song(!0),e.artist=s.artist(!0),e.album=s.album(!0),e.albumart=s.albumart(!0),e.playlist=s.playlist(!0),e.playlists=s.playlists(!0),e.elapsedTime=s.elapsedtime(!0),e.totalTime=s.totaltime(!0),a.postMessage(e)}),i.songinfo.observe(document.querySelector(".centerCenter"),{subtree:!0,characterData:!0,childList:!0}),i.volume=new MutationObserver(function(){void 0!==s.volume(!0)&&a.postMessage({volume:u.volume})}),i.volume.observe(document.querySelector(".volumeContainer .ui-slider-range"),{attributes:!0,attributeFilter:["style"]}),i.playlists=new MutationObserver(function(){void 0!==s.playlists(!0)&&a.postMessage({playlists:u.playlists})}),i.playlists.observe(document.querySelector("#playlistSection"),{childList:!0}),i.moderepeat=new MutationObserver(function(){void 0!==s.moderepeat(!0)&&a.postMessage({moderepeat:u.moderepeat})}),i.moderepeat.observe(document.querySelector(".repeatButton"),{attributes:!0,attributeFilter:["class"]}),i.modeshuffle=new MutationObserver(function(){void 0!==s.modeshuffle(!0)&&a.postMessage({modeshuffle:u.modeshuffle})}),i.modeshuffle.observe(document.querySelector(".shuffleButton"),{attributes:!0,attributeFilter:["class"]})},v=function(){if(a)try{a.disconnect()}catch(e){}a=null,runningamazoncloud=void 0;for(var t in i)i[t].disconnect();chrome.storage.onChanged.removeListener(o)},p=function(e){"play"==e.action&&l.play(),"pause"==e.action&&l.pause(),"forcepaused"==e.action&&l.forcepaused(),"prev"==e.action&&l.prev(),"next"==e.action&&l.next(),"thumbup"==e.action&&l.songvote(1),"thumbdown"==e.action&&l.songvote(-1),"setvolume"==e.action&&l.volume(e.volume),"seek"==e.action&&l.seek(e.seek),"setplaylist"==e.action&&l.playlist(e.playlist),"togglerepeat"==e.action&&l.moderepeat(!s.moderepeat()),"toggleshuffle"==e.action&&l.modeshuffle(!s.modeshuffle())},f=function(){var e=function(){return document.querySelector(".mp3MasterPlay")&&document.querySelector(".volumeContainer .ui-slider-range")&&document.querySelector(".centerCenter")?void m():setTimeout(e,500)};setTimeout(e,10)}}()}