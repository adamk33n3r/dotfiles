if("undefined"==typeof runningbeatsmusic){var runningbeatsmusic=!0,exports={};!function(){var e={},t={},o=2;chrome.storage.local.get(null,function(t){e=t,0==--o&&b()}),chrome.storage.sync.get(null,function(e){if(t=e,!t.test)for(var n in console)console[n]=function(){};0==--o&&b()});var n=function(o,n){if("local"==n)for(var r in o)e[r]=o[r].newValue;else if("sync"==n)for(var r in o)t[r]=o[r].newValue};chrome.storage.onChanged.addListener(n);var r=function(e,t,o){if(e){t=t||0,o=o||0;var n=document.createEvent("MouseEvents");n.initMouseEvent("mousedown",!0,!0,window,1,0,0,t,o,!1,!1,!1,!1,0,null),e.dispatchEvent(n),n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,window,1,0,0,t,o,!1,!1,!1,!1,0,null),e.dispatchEvent(n),n=document.createEvent("MouseEvents"),n.initMouseEvent("mouseup",!0,!0,window,1,0,0,t,o,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}};window.MutationObserver=window.MutationObserver||window.WebkitMutationObserver;var s={},a=null,i={},u={},c={},l=!1,d=function(e,t,o){return o&&t===i[e]?void 0:i[e]=t};u.isplaying=function(e){var t=document.querySelector("#play_pause_icon.icon-bicons_pause");return d("isplaying",!!t,e)},u.song=function(e){var t=document.querySelector(".track");return d("song",t?t.innerText.replace(/\s/g," ").trim():"",e)},u.artist=function(e){var t=document.querySelector(".artist");return d("artist",t?t.innerText.replace(/\s/g," ").trim():"",e)},u.album=function(e){return d("album","",e)},u.albumart=function(e){var t=document.querySelector("#t-art");return d("albumart",t?t.style.backgroundImage.replace(/^url\(/,"").replace(/\)$/,"").replace("size=small","size=large"):"",e)},u.songvote=function(e){return d("songvote",document.querySelector("#t-love.active")?1:document.querySelector("#t-hate.active")?-1:0,e)},u.volume=function(e){var t=document.querySelector(".current-volume");return d("volume",t?parseFloat(t.getAttribute("style").replace(/[^\d.]/g,""))/100:1,e)},u.playlists=function(e){var t=[];return d("playlists",t,e)},u.playlist=function(e){var t=null;return d("playlist",t?t.innerText:"",e)},u.elapsedtime=function(e){var t=document.querySelector(".horizontal_bar__tooltip");return t=t?t.innerText.trim().match(/^(\d*\d):(\d\d)/):void 0,t=t?60*t[1]+1*t[2]:void 0,d("elapsedtime",t||0,e)},u.totaltime=function(e){var t=document.querySelector(".horizontal_bar__tooltip");return t=t?t.innerText.trim().match(/(\d*\d):(\d\d)$/):void 0,t=t?60*t[1]+1*t[2]:void 0,d("totaltime",t||1,e)},u.moderepeat=function(e){return d("moderepeat",document.querySelector("#t-repeat.repeat-all")?"on":document.querySelector("#t-repeat.repeat-one")?"one":!1,e)},u.modeshuffle=function(e){return d("modeshuffle",!!document.querySelector("#t-shuffle.shuffle-on"),e)},u.adwatch=function(e){return d("adwatch",!1,e)},c.play=function(){l=!1,r(document.querySelector("#play_pause_icon.icon-bicons_play"))},c.pause=function(){r(document.querySelector("#play_pause_icon.icon-bicons_pause"))},c.forcepaused=function(){l=!0,c.pause();var e=function(){l=!1,document.querySelector("#play_pause_icon").removeEventListener("click",e,!0),document.querySelector("#t-prev").removeEventListener("click",e,!0),document.querySelector("#t-next").removeEventListener("click",e,!0)};document.querySelector("#play_pause_icon").addEventListener("click",e,!0),document.querySelector("#t-prev").addEventListener("click",e,!0),document.querySelector("#t-next").addEventListener("click",e,!0)},c.prev=function(){l=!1,r(document.querySelector("#t-prev"))},c.next=function(){l=!1,r(document.querySelector("#t-next"))},c.songvote=function(e){e>0||0==e&&document.querySelector("#t-love.active")?r(document.querySelector("#t-love")):(0>e||0==e&&document.querySelector("#t-hate.active"))&&r(document.querySelector("#t-hate"))},c.volume=function(e){var t=document.querySelector(".volume__slider"),o=t.style.display;t.style.display="block";var n=document.querySelector("#t-volume-scrubber"),s=0,a=n;do s+=a.offsetLeft;while(a=a.offsetParent);s+=n.offsetWidth*e,r(n,s,0),t.style.display=o},c.seek=function(e){var t=document.querySelector(".transport__scrubber .horizontal_bar__container"),o=0,n=t;do o+=n.offsetLeft;while(n=n.offsetParent);o+=t.offsetWidth*e,r(t,o,0)},c.playlist=function(){},c.moderepeat=function(){r(document.querySelector("#t-repeat"))},c.modeshuffle=function(){r(document.querySelector("#t-shuffle"))};var p=function(){console.log("]]connect-beatsmusic"),a=chrome.extension.connect({name:JSON.stringify({name:"playerport",type:"beatsmusic",isplaying:u.isplaying(),song:u.song(),artist:u.artist(),album:u.album(),albumart:u.albumart(),songvote:u.songvote(),volume:u.volume(),playlists:u.playlists(),playlist:u.playlist(),moderepeat:u.moderepeat(),modeshuffle:u.modeshuffle()})}),a.onMessage.addListener(g),a.onDisconnect.addListener(y),a._postMessage=a.postMessage,a.postMessage=function(){try{a._postMessage.apply(a,arguments)}catch(e){y()}},window.addEventListener("pushstate",v,!0),window.addEventListener("popstate",v,!0),s={},s.playpause=new MutationObserver(function(){void 0!==u.isplaying(!0)&&(l&&i.isplaying?c.forcepaused():a.postMessage({isplaying:i.isplaying}))}),s.playpause.observe(document.querySelector(".controls"),{subtree:!0,attributes:!0,attributeFilter:["class"]}),s.songinfo=new MutationObserver(function(){var e={};e.song=u.song(!0),e.artist=u.artist(!0),e.album=u.album(!0),e.albumart=u.albumart(!0),e.playlist=u.playlist(!0),e.playlists=u.playlists(!0),e.songvote=u.songvote(!0),a.postMessage(e)}),s.songinfo.observe(document.querySelector(".artist-track-target"),{subtree:!0,characterData:!0,childList:!0}),s.songvote=new MutationObserver(function(){void 0!==u.songvote(!0)&&a.postMessage({songvote:i.songvote})}),s.songvote.observe(document.querySelector(".transport__rating"),{subtree:!0,childList:!0,attributes:!0,attributeFilter:["class"]}),s.progress=new MutationObserver(function(){var e={};e.elapsedTime=u.elapsedtime(!0),e.totalTime=u.totaltime(!0),a.postMessage(e)}),s.progress.observe(document.querySelector(".transport__scrubber"),{subtree:!0,characterData:!0}),s.controls=new MutationObserver(function(){var e={};e.volume=u.volume(!0),e.moderepeat=u.moderepeat(!0),e.modeshuffle=u.modeshuffle(!0),a.postMessage(e)}),s.controls.observe(document.querySelector(".transport__volume"),{subtree:!0,childList:!0,attributes:!0,attributeFilter:["class","style"]})},v=function(){setTimeout(function(){void 0!==u.playlists(!0)&&a.postMessage({playlists:i.playlists})},1e3)},m=function(){var e=window.history.pushState.bind(window.history);window.history.pushState=function(t,o,n){e(t,o,n);var r=document.createEvent("Event");r.initEvent("pushstate",!0,!0,window),window.dispatchEvent(r)}},f=document.createElement("script");f.id="pushstateevent",f.innerText="if(!window.pushstateeventflag)("+m.toString()+")();window.pushstateeventflag=true;document.body.removeChild(document.querySelector('#"+f.id+"'));",document.body.appendChild(f);var y=function(){if(a)try{a.disconnect()}catch(e){}a=null,runningbeatsmusic=void 0,window.removeEventListener("pushstate",v,!0),window.removeEventListener("popstate",v,!0);for(var t in s)s[t].disconnect();chrome.storage.onChanged.removeListener(n)},g=function(e){"play"==e.action&&c.play(),"pause"==e.action&&c.pause(),"forcepaused"==e.action&&c.forcepaused(),"prev"==e.action&&c.prev(),"next"==e.action&&c.next(),"thumbup"==e.action&&c.songvote(1),"thumbdown"==e.action&&c.songvote(-1),"songvote"==e.action&&c.songvote(e.songvote),"setvolume"==e.action&&c.volume(e.volume),"seek"==e.action&&c.seek(e.seek),"setplaylist"==e.action&&c.playlist(e.playlist),"togglerepeat"==e.action&&c.moderepeat(!u.moderepeat()),"toggleshuffle"==e.action&&c.modeshuffle(!u.modeshuffle())},b=function(){var e=function(){return document.querySelector("#play_pause_icon")?void p():setTimeout(e,500)};setTimeout(e,10)}}()}