!function(){var e={};for(a in console)e[a]=console[a];if("update_url"in chrome.runtime.getManifest())for(a in console)console[a]=function(){};var t={},i={},o=function(e,i){Date.now();for(key in e)void 0!==e[key]?t[key]=e[key]:(delete t[key],chrome.storage.local.remove(key));chrome.storage.local.set(e,i)},n=function(e,t){Date.now();for(key in e)void 0!==e[key]?i[key]=e[key]:(delete i[key],chrome.storage.sync.remove(key));chrome.storage.sync.set(e,t)},s={};s.initcount=2,chrome.storage.local.get(null,function(e){chrome.runtime.lastError?(s.failed||alert("Google Chrome's storage may be corrupted. Extensions may not work properly.\n\nTry closing and restarting Chrome.\n\nIf that doesn't work, reinstall the browser to fix this problem."),s.failed=!0,console.log("chrome.storage failure")):t=e,0==--s.initcount&&s.init()}),chrome.storage.sync.get(null,function(e){chrome.runtime.lastError?(s.failed||alert("Google Chrome's storage may be corrupted. Extensions may not work properly.\n\nTry closing and restarting Chrome.\n\nIf that doesn't work, reinstall the browser to fix this problem."),s.failed=!0,console.log("chrome.storage failure")):i=e,0==--s.initcount&&s.init()}),s.changed=function(e,o){var n={},a=[],r={},l=[],c=Date.now();if("local"==o){for(key in e)"newValue"in e[key]?(t[key]=e[key].newValue,i.sync&&i.sync[key]&&!key.match(/\+ts$/)&&(i[key]=r[key]=e[key].newValue,t[key+"+ts"]=n[key+"+ts"]=c,i[key+"+ts"]=r[key+"+ts"]=c)):(delete t[key],delete t[key+"+ts"],a.push(key+"+ts"),i.sync&&i.sync[key]&&(delete i[key],delete i[key+"+ts"],l.push(key),l.push(key+"+ts")));s.localChanged(e)}else if("sync"==o){if(e.firstinstalled){if(!e.firstinstalled.newValue)return void chrome.storage.sync.set(i);var d=e.firstinstalled.newValue;d=i.firstinstalled&&i.firstinstalled<d?i.firstinstalled:d,d=e.firstinstalled.oldValue&&e.firstinstalled.oldValue<d?e.firstinstalled.oldValue:d,e.firstinstalled.newValue>d&&(e.firstinstalled.newValue=d,chrome.storage.sync.set({firstinstalled:d}))}var n={},a=[];for(key in e)"newValue"in e[key]?(i[key]=e[key].newValue,i.sync&&i.sync[key]&&!key.match(/\+ts$/)&&(t[key]=n[key]=e[key].newValue,i[key+"+ts"]=r[key+"+ts"]=c,t[key+"+ts"]=n[key+"+ts"]=c)):(delete i[key],delete i[key+"+ts"],l.push(key+"+ts"),i.sync&&i.sync[key]&&(delete t[key],delete t[key+"+ts"],a.push(key),a.push(key+"+ts")));s.syncChanged(e)}Object.keys(n).length&&chrome.storage.local.set(n),a.length&&chrome.storage.local.remove(a),Object.keys(r).length&&chrome.storage.sync.set(r),l.length&&chrome.storage.sync.remove(l)},chrome.storage.onChanged.addListener(s.changed);var r=function(e,t){e=e.split("."),t=t.split(".");for(var i=0;i<e.length&&i<t.length;i++)if(parseInt(e[i])!=parseInt(t[i]))return parseInt(e[i])>parseInt(t[i]);return e.length>t.length};s.init=function(){i.firstinstalled||(i.firstinstalled=Date.now(),i.sync={firstinstalled:!0},i.started={},i.version=chrome.runtime.getManifest().version,i.clickset=["playpause","popup","togglefocus"],i.songnotify=3,i.artbutton=!1,i.bigart=!0,i.active={pandora:!0},i.pintab={},i.autocontinue={pandora:!0,googlemusic:!0,grooveshark:!0,digitallyimported:!0,soundcloud:!0,playspotify:!0,cmdfm:!0,amazoncloud:!0,audiovideo:!0,songza:!0,rdio:!0,stitcher:!0,iheart:!0,"8tracks":!0,beatsmusic:!0,slacker:!0,tunein:!0,radio:!0,earbits:!0},i.ignoreautopause={},i.closereview=!1,i.hidetab=!1,i.advolume=1,i.listening=!1),void 0===i.skipvideoad&&(i.skipvideoad={pandora:!1}),void 0===i.initplaystate&&(i.initplaystate={pandora:0}),t.installed||(t.installed=Date.now(),t.id="i"+Math.round(1e16*Math.random()),t.license=""),t.activeplayer||(t.activeplayer=null),i.firstinstalled>t.installed&&(i.firstinstalled=t.installed);for(var e in i.sync)i.sync[e]&&void 0!==i[e]?t[e]=i[e]:i.sync[e]&&void 0!==t[e]&&(i[e]=t[e]);t.started=Date.now(),i.started[t.id]=Date.now(),t.session=Math.floor(Math.random()*Math.pow(2,30)).toString(32)+Math.floor(Math.random()*Math.pow(2,30)).toString(32),r(chrome.runtime.getManifest().version,i.version)&&(i.version=chrome.runtime.getManifest().version),"boolean"==typeof i.pintab&&(i.pintab={pandora:i.pintab}),i.autocontinue={pandora:!0,googlemusic:!0,grooveshark:!0,digitallyimported:!0,soundcloud:!0,playspotify:!0,cmdfm:!0,amazoncloud:!0,audiovideo:!0,songza:!0,rdio:!0,stitcher:!0,iheart:!0,"8tracks":!0,beatsmusic:!0,slacker:!0,tunein:!0,radio:!0,earbits:!0},void 0!==i.ignoreautopause.length&&(i.ignoreautopause={}),-1!=i.clickset.indexOf("closepopup")&&i.clickset.splice(i.clickset.indexOf("closepopup"),1),t.plus&&(t.license=t.plus,delete t.plus,setTimeout(function(){chrome.storage.local.remove("plus")},5e3)),t.license||(t.license=""),i.timer_end||(i.timer_end="song"),i.timer_minutes||(i.timer_minutes=0),h=t.license,chrome.storage.sync.set(i,function(){chrome.storage.local.set(t,E)})},s.localChanged=function(e){t.needping&&(L(),o({needping:void 0})),t.license!=h&&o({license:h}),e.pandora_noadvolume&&e.pandora_noadvolume.oldValue&&e.pandora_noadvolume.newValue&&o({pandora_noadvolume:e.pandora_noadvolume.oldValue})},s.syncChanged=function(e){if(e.clickset&&f.setPopup(),e.pintab)for(var t=0;t<m.length;t++)m[t]._tabid>=0&&chrome.tabs.update(m[t]._tabid,{pinned:i.pintab[m[t].type]});if(e.hidetab)for(var t=0;t<m.length;t++)"pandora"==m[t].type&&(i.hidetab&&m[t]._tabid>=0&&S(),!i.hidetab&&m[t]._tabid<0&&chrome.tabs.create({url:"http://www.pandora.com",active:!1,pinned:i.pintab[m[t].type]}));if(e.active){chrome.windows.getAll({populate:!0},function(e){for(var t=0;t<e.length;t++)for(var i=0;i<e[t].tabs.length;i++)C(e[t].tabs[i],!0)});for(var o=[],t=0;t<m.length;t++)i.active[m[t].type]||o.push(m[t]);for(var t=0;t<o.length;t++)o[t].disconnect()}e.version&&"1.16.3"==i.version&&e.version.oldValue&&"1.16.3"!=e.version.oldValue&&chrome.tabs.create({url:chrome.runtime.getURL("changelog.html")})};var l=function(e){if(!chrome.runtime.lastError)return!1;var t=chrome.runtime.lastError.message;console.error("["+e+","+new Date+"]",t);var i=localStorage.errorlog?JSON.parse(localStorage.errorlog):[];for(i.push([Date.now(),e,t]);i.length>500;)i.shift();return localStorage.errorlog=JSON.stringify(i),!t.match(/^Cannot access contents of url/),chrome.storage.local.set({errorlog:i}),!0},c=function(e){open(chrome.runtime.getURL("plusalert.html#"+e),"plusalert","width=600,height=300,left="+(screen.availWidth-600)/2+",top="+((screen.availHeight-300)/2-100))},d=function(e,t){this.id=Math.floor(Math.random()*Math.pow(2,30)).toString(32)+Math.floor(Math.random()*Math.pow(2,30)).toString(32),this.type=t,this.isplaying=!1,this.elapsedTime=0,this.totalTime=0,this.volume=1,this.song="",this.artist="",this.album="",this.albumart="/im/albumart.png",this.songvote=0,this.playlists=[],this.playlist="",this.closed=!1,e.sender.tab||(e.sender.tab={id:-1,pinned:!1}),this._port=e,this._tabid=e.sender.tab.id,e.onDisconnect.addListener(this.disconnect.bind(this)),e.onMessage.addListener(this.onmessage.bind(this)),!!i.pintab[this.type]!=!!e.sender.tab.pinned&&this._tabid>=0&&chrome.tabs.update(this._tabid,{pinned:i.pintab[this.type]}),i.initplaystate[this.type]>0&&this._port.postMessage({action:"play"}),i.initplaystate[this.type]<0&&this._port.postMessage({action:"pause"})};d.prototype.play=function(){this._port.postMessage({action:"play"})},d.prototype.pause=function(){this._port.postMessage({action:"pause"})},d.prototype.playpause=function(){this._port.postMessage({action:this.isplaying?"pause":"play"})},d.prototype.next=function(){this._port.postMessage({action:"next"})},d.prototype.prev=function(){this._port.postMessage({action:"prev"})},d.prototype.thumbup=function(){this._port.postMessage({action:"thumbup"})},d.prototype.thumbdown=function(){this._port.postMessage({action:"thumbdown"})},d.prototype.setsongvote=function(e){console.log("songvote",e),this._port.postMessage({action:"songvote",songvote:e})},d.prototype.tired=function(){this._port.postMessage({action:"tired"})},d.prototype.seek=function(e){this._port.postMessage({action:"seek",seek:e})},d.prototype.setvolume=function(e){this._port.postMessage({action:"setvolume",volume:e})},d.prototype.togglerepeat=function(){this._port.postMessage({action:"togglerepeat"})},d.prototype.toggleshuffle=function(){this._port.postMessage({action:"toggleshuffle"})},d.prototype.setplaylist=function(e){e!=this.playlist&&(this.playlist=null),this._port.postMessage({action:"setplaylist",playlist:e})},d.prototype.togglefocus=function(){this._tabid>=0&&chrome.tabs.query({currentWindow:!0,active:!0},function(e){chrome.tabs.get(e[0]&&e[0].id==this._tabid&&u.lasttabid?u.lasttabid:this._tabid,function(e){chrome.windows.update(e.windowId,{focused:!0}),chrome.tabs.update(e.id,{active:!0})}.bind(this))}.bind(this))},d.prototype.disconnect=function(){this.closed||(this.closed=!0,this._port.disconnect(),b(this),f.setIcon(),f.setTitle())},d.prototype.onmessage=function(e){if(e.ping&&this._port.postMessage({pong:!0}),e.optionsopen&&chrome.tabs.create({url:chrome.runtime.getURL("options.html")}),e.requestfocus&&(this._tabid>=0?chrome.tabs.get(this._tabid,function(e){chrome.windows.update(e.windowId,{focused:!0}),chrome.tabs.update(e.id,{active:!0})}):chrome.tabs.create({url:"http://www.pandora.com",active:!0,pinned:i.pintab.pandora})),e.showerror){var t=webkitNotifications.createNotification("/im/icon128.png","",e.showerror);t.show(),setTimeout(function(){t.cancel(),t.close()},1e4)}return e.albumart&&!e.albumart.match(/^(data:[^,]+,.+|https?:\/\/[^\/]+\/.+)$/)&&delete e.albumart,(e.isplaying&&!this.isplaying||e.song&&e.song!=this.song||e.artist&&e.artist!=this.artist||e.album&&e.album!=this.album||e.albumart&&e.albumart!=this.albumart)&&setTimeout(F,e.isplaying||e.albumart?0:1e3,this),(void 0!==e.isplaying||void 0!==e.volume)&&((!this.isplaying||0==this.volume)&&(void 0!==e.isplaying?e.isplaying:this.isplaying)&&(void 0!==e.volume?e.volume:this.volume)>0&&setTimeout(function(){if("pandora"==e.type)for(var t=0;t<m.length;t++)m[t]!=this&&m[t].type==e.type&&(m[t]._tabid>=0?chrome.tabs.remove(m[t]._tabid):D());o({activeplayer:this.type}),delete this.interrupted,w(this)}.bind(this),0),this.isplaying&&this.volume>0&&(!(void 0!==e.isplaying?e.isplaying:this.isplaying)||0==(void 0!==e.volume?e.volume:this.volume))&&setTimeout(function(){T(),j()}.bind(this),0)),void 0!==e.isplaying&&(this.isplaying=e.isplaying),void 0!==e.elapsedTime&&(this.elapsedTime=e.elapsedTime),void 0!==e.totalTime&&(this.totalTime=e.totalTime),void 0!==e.volume&&(this.volume=e.volume),void 0!==e.song&&(this.song=e.song),void 0!==e.artist&&(this.artist=e.artist),void 0!==e.album&&(this.album=e.album),void 0!==e.albumart&&(this.albumart=e.albumart.match(/^([^:]+:\/\/|data:.{10})/)?e.albumart:"/im/albumart.png"),void 0!==e.songvote&&(this.songvote=e.songvote),void 0!==e.playlists&&(this.playlists=e.playlists),void 0!==e.playlist&&(this.playlist=e.playlist),void 0!==e.moderepeat&&(this.moderepeat=e.moderepeat),void 0!==e.modeshuffle&&(this.modeshuffle=e.modeshuffle),console.log(Date.now(),"mess",e),this!=p?void(void 0!==e.isplaying&&g.updateMorePlayers()):((void 0!==e.isplaying||void 0!==e.elapsedTime||void 0!==e.totalTime||void 0!==e.albumart)&&f.setIcon(),(void 0!==e.elapsedTime||void 0!==e.totalTime)&&g.updateProgress(),void 0!==e.volume&&g.updateVolume(),(e.song||e.artist||e.album||void 0!==e.songvote)&&f.setTitle(),(e.song||e.artist||e.album||void 0!==e.songvote||void 0!==e.isplaying||void 0!==e.albumart)&&g.updateInfo(),(void 0!==e.playlists||void 0!==e.playlist)&&g.updatePlaylists(),void((void 0!==e.modeshuffle||void 0!==e.moderepeat)&&g.updateModes()))};var u={},p=null,m=[],h="",f=null,g=null,v=null,y=function(e){m.push(e),p=m[0]},b=function(e){var t=m.indexOf(e);0>t||(m.splice(t,1),p=m[0],e.isplaying&&e.volume>0&&(T(),j()),H())},w=function(e){var t=m.indexOf(e);if(!(0>t)){for(var o=0;o<m.length;o++)m[o].isplaying&&m[o].volume>0&&m[o]!=e&&(!i.ignoreautopause[e.type]||m[o].type!=e.type)&&(m[o].interrupted=!0,m[o].pause());if(!(0>=t)){var n=m.splice(t,1);m=n.concat(m),p=m[0],H(),F(e)}}},k=function(){if(console.log("default",i.active),i.active.pandora)return"pandora";for(var e in i.active)if(i.active[e])return e},x=function(e,t){if(e||(e=function(){}),t||(t=function(){}),p)return e();var o=k();if(!o)return t();var n={pandora:"http://pandora.com/",youtube:"http://www.youtube.com/",googlemusic:"http://play.google.com/music/",grooveshark:"http://grooveshark.com/",digitallyimported:"http://www.di.fm/",soundcloud:"https://soundcloud.com/",playspotify:"https://play.spotify.com",cmdfm:"https://cmd.fm",amazoncloud:"https://www.amazon.com/gp/dmusic/cloudplayer/web",audiovideo:"http://www.html5rocks.com/en/tutorials/video/basics/",songza:"http://songza.com/",rdio:"https://www.rdio.com/",stitcher:"http://app.stitcher.com/",iheart:"http://www.iheart.com/","8tracks":"http://8tracks.com/",beatsmusic:"https://listen.beatsmusic.com/",slacker:"http://www.slacker.com/",tunein:"http://tunein.com/",radio:"http://player.radio.com/",earbits:"http://www.earbits.com/"};"pandora"==o?i.hidetab?S():chrome.tabs.create({url:"http://www.pandora.com",active:!1,pinned:i.pintab.pandora}):chrome.tabs.create({url:n[o]});var a=15e3,s=function(){return p?e():(a-=!1)?t():void setTimeout(s,200)};setTimeout(s,200)},T=function(){for(var e=0;e<m.length;e++)if(m[e].isplaying&&m[e].volume>0)return void o({activeplayer:m[e].type});o({activeplayer:null})},_=function(e){-1!=["togglefocus","playpause","next","prev","thumbup","thumbdown","tired"].indexOf(e)&&(t.license||(t.howtoshown?(!t.promo2||t.promo2<Date.now()-2592e6)&&(open(chrome.runtime.getURL("promo2.html"),"promo2","width=700,height=400,left="+(screen.availWidth/2-350)+",top="+(screen.availHeight/2-200-50)),o({promo2:Date.now()})):chrome.tabs.create({url:chrome.extension.getURL("howto.html")},function(){o({howtoshown:!0,promo2:Date.now()})})),(p&&!m[0]||V.shown)&&V(),x(function(){"togglefocus"==e?p.togglefocus():"playpause"==e?(p.volume>0&&I(),p.isplaying?p.pause():p.play()):"next"==e?(p.next(),f.setIcon("im/action-next.png",800)):"prev"==e?(p.prev(),f.setIcon("im/action-prev.png",800)):"thumbup"==e?(p.thumbup(),f.setIcon("im/action-thumbup.png",800)):"thumbdown"==e?(p.thumbdown(),f.setIcon("im/action-thumbdown.png",800)):"tired"==e&&p.tired()}))},j=function(){for(var e=!1,i=0;i<m.length;i++)if(m[i].interrupted){e=m[i];break}e&&setTimeout(function(){e.interrupted&&null==t.activeplayer&&e.play()},2e3)},I=function(){for(var e=0;e<m.length;e++)m[e].interrupted&&delete m[e].interrupted},M={};M.time=null,M.interval=null,M.timeout=null,M.update=function(){if(!p)return M.off();var e=M.time-Date.now();if(v("#menutimer .icon").css({visibility:Math.floor(e/1e3)%2==0?"hidden":"visible"}),1e3>e){var t=Math.max(0,e);if("song"==i.timer_end){var o=p.totalTime-p.elapsedTime;clearInterval(M.interval),t=1e3*o,setTimeout(function(){v("#menutimer .icon").html("&times;")},0)}M.timeout=setTimeout(function(){I(),p&&p.isplaying&&p.pause(),M.off()},t)}v("#menutimer .icon").text(Math.ceil(e/60/1e3))},M.on=function(){!t.license&&t.installed>14085972e5&&c("Auto-pause Timer"),p&&p.isplaying&&(M.time=Date.now()+60*i.timer_minutes*1e3,M.interval=setInterval(M.update,1e3),v("#menutimer").addClass("timing"),M.update())},M.off=function(){M.time=null,clearInterval(M.interval),M.interval=null,clearTimeout(M.timeout),M.timeout=null,v("#menutimer").removeClass("timing"),v("#menutimer .icon").css({visibility:""})};var z={};z.interrupt_idle=!1,z.interrupt_lock=!1,z.state="active",chrome.idle.setDetectionInterval(60),chrome.idle.queryState(60,function(e){console.log(Date.now(),"INIT",e),z.state=e}),chrome.idle.onStateChanged.addListener(function(e){console.log(Date.now(),"IDLE",z.state,e),t.license.match(/plus$/)&&i.pauselocked&&"locked"==e&&p&&p.isplaying&&(p.volume>0&&I(),p.pause(),z.interrupt_lock=!0),"locked"!=e&&z.interrupt_lock&&(z.interrupt_lock=!1),z.state=e});var C=function(e,o,n){return o&&i.active.pandora&&e.url.match(/^http:\/\/([^\/]+\.)*pandora\.com\//)?void chrome.tabs.executeScript(e.id,{file:"js/pandora.js",allFrames:n},l.bind(null,"execinject")):(i.active.pandora&&e.url.match(/^https:\/\/([^\/]+\.)*pandora\.com\//)&&chrome.permissions.contains({origins:["*://*.pandora.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/pandora.js",allFrames:n},l.bind(null,"execinject"))}),void(t.license&&(i.active.youtube&&e.url.match(/^https?:\/\/([^\/]+\.)*youtube(-nocookie)?\.com\//)&&chrome.permissions.contains({origins:["*://*.youtube.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/youtube.js",allFrames:n},l.bind(null,"execinject"))}),i.active.googlemusic&&e.url.match(/^https?:\/\/play\.google\.com\/music\//)&&chrome.permissions.contains({origins:["*://play.google.com/music/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/googlemusic.js",allFrames:n},l.bind(null,"execinject"))}),i.active.grooveshark&&e.url.match(/^https?:\/\/grooveshark\.com\//)&&chrome.permissions.contains({origins:["*://*.grooveshark.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/grooveshark.js",allFrames:n},l.bind(null,"execinject"))}),i.active.digitallyimported&&e.url.match(/^https?:\/\/www\.di\.fm\//)&&chrome.permissions.contains({origins:["*://*.di.fm/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/digitallyimported.js",allFrames:n},l.bind(null,"execinject"))}),i.active.soundcloud&&e.url.match(/^https?:\/\/soundcloud\.com\//)&&chrome.permissions.contains({origins:["*://*.soundcloud.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/soundcloud.js",allFrames:n},l.bind(null,"execinject"))}),i.active.playspotify&&e.url.match(/^https?:\/\/play.spotify\.com\//)&&chrome.permissions.contains({origins:["*://*.spotify.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/playspotify.js",allFrames:!0},l.bind(null,"execinject"))}),i.active.cmdfm&&e.url.match(/^https?:\/\/cmd\.fm\//)&&chrome.permissions.contains({origins:["*://*.cmd.fm/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/cmdfm.js",allFrames:n},l.bind(null,"execinject"))}),i.active.amazoncloud&&e.url.match(/^https?:\/\/www\.amazon\.com\/.*player.*/)&&chrome.permissions.contains({origins:["*://*.amazon.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/amazoncloud.js",allFrames:n},l.bind(null,"execinject"))}),i.active.songza&&e.url.match(/^https?:\/\/songza\.com\//)&&chrome.permissions.contains({origins:["*://*.songza.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/songza.js",allFrames:n},l.bind(null,"execinject"))}),i.active.rdio&&e.url.match(/^https?:\/\/www\.rdio\.com\//)&&chrome.permissions.contains({origins:["*://*.rdio.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/rdio.js",allFrames:n},l.bind(null,"execinject"))}),i.active.stitcher&&e.url.match(/^https?:\/\/app\.stitcher\.com\//)&&chrome.permissions.contains({origins:["*://*.stitcher.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/stitcher.js",allFrames:n},l.bind(null,"execinject"))}),i.active.iheart&&e.url.match(/^https?:\/\/www\.iheart\.com\//)&&chrome.permissions.contains({origins:["*://*.iheart.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/iheart.js",allFrames:n},l.bind(null,"execinject"))}),i.active["8tracks"]&&e.url.match(/^https?:\/\/8tracks\.com\//)&&chrome.permissions.contains({origins:["*://*.8tracks.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/8tracks.js",allFrames:n},l.bind(null,"execinject"))}),i.active.beatsmusic&&e.url.match(/^https?:\/\/listen\.beatsmusic\.com\//)&&chrome.permissions.contains({origins:["*://*.beatsmusic.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/beatsmusic.js",allFrames:n},l.bind(null,"execinject"))}),i.active.slacker&&e.url.match(/^https?:\/\/www\.slacker\.com\//)&&chrome.permissions.contains({origins:["*://*.slacker.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/slacker.js",allFrames:n},l.bind(null,"execinject"))}),i.active.tunein&&e.url.match(/^https?:\/\/tunein\.com\//)&&chrome.permissions.contains({origins:["*://*.tunein.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/tunein.js",allFrames:n},l.bind(null,"execinject"))}),i.active.radio&&e.url.match(/^https?:\/\/player\.radio\.com\//)&&chrome.permissions.contains({origins:["*://*.radio.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/radio.js",allFrames:n},l.bind(null,"execinject"))}),i.active.earbits&&e.url.match(/^https?:\/\/www\.earbits\.com\//)&&chrome.permissions.contains({origins:["*://*.earbits.com/*"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/earbits.js",allFrames:n},l.bind(null,"execinject"))}),i.active.audiovideo&&!e.url.match(/^(file:|chrome(-[^:]+)?:\/\/|https:\/\/chrome\.google\.com\/webstore|https?:\/\/([^\/]+\.)*youtube(-nocookie)?\.com\/|https?:\/\/app\.stitcher\.com\/|https?:\/\/www\.slacker\.com\/)/)&&chrome.permissions.contains({origins:["<all_urls>"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/audiovideo.js",allFrames:!0},l.bind(null,"execinject"))}),!i.active.audiovideo&&!i.active.youtubeall||e.url.match(/^(file:|chrome(-[^:]+)?:\/\/|https:\/\/chrome\.google\.com\/webstore)/)||chrome.permissions.contains({origins:["<all_urls>"]},function(t){t&&chrome.tabs.executeScript(e.id,{file:"js/all_urls.js",allFrames:!0},l.bind(null,"execinject"))}))))},F=function(e){i.songnotify&&e&&e.isplaying&&e.song&&(g.window&&e==p&&i.songnotify<1e3||chrome.tabs.query({currentWindow:!0,active:!0},function(t){if(!t[0]||t[0].id!=e._tabid){var o=function(){return e.song},n=function(){return(1==e.songvote?"▲ ":-1==e.songvote?"▼ ":"")+e.artist+(e.artist&&e.album?"  -  ":"")+e.album},a=function(){return e.albumart};return i.songnotify>8?(u.notify_timeout&&clearTimeout(u.notify_timeout),void(u.notify_timeout=setTimeout(function(){var t=new Notification(o(),{tag:"songnotify",body:n(),icon:a()}),s=Date.now();u.notify_progress&&clearInterval(u.notify_progress),u.notify_progress=setInterval(function(){(!e.isplaying||Date.now()>s+1e3*i.songnotify)&&(t.close(),clearInterval(u.notify_progress))},2e3)},2e3))):void chrome.notifications.getAll(function(t){var s={type:"basic",title:o(),message:n(),iconUrl:a(),eventTime:Date.now(),priority:1};!i.hidenotifyprogress&&e.totalTime&&(s.type="progress",s.progress=Math.round(100*e.elapsedTime/e.totalTime));var r=function(){chrome.runtime.lastError&&"Unable to download all specified images."==chrome.runtime.lastError.message&&(s.iconUrl="/im/icon128.png",chrome.notifications.create("songnotify",s,function(){})),u.notify_progress&&clearInterval(u.notify_progress),u.notify_progress=setInterval(function(){if(e.isplaying&&Date.now()<s.eventTime+1e3*i.songnotify){var t=s.title,r=s.message,l=s.iconUrl,c=s.progress;s.title=o(),s.message=n(),s.iconUrl=a(),i.hidenotifyprogress||(s.progress=e.totalTime?Math.round(100*e.elapsedTime/e.totalTime):0),console.log("ud",l,s.iconUrl),(t!=s.title||r!=s.message||l!=s.iconUrl||c!=s.progress)&&chrome.notifications.update("songnotify",s,function(){})}else chrome.notifications.clear("songnotify",function(){}),clearInterval(u.notify_progress)},300)};t.songnotify?chrome.notifications.update("songnotify",s,function(){}):(u.notify_timeout&&clearTimeout(u.notify_timeout),u.notify_timeout=setTimeout(function(){chrome.notifications.create("songnotify",s,r)},500))})}}))};chrome.notifications.onClicked.addListener(function(e){console.log("click notif",e)}),chrome.notifications.onButtonClicked.addListener(function(e,t){console.log("click notif button",e,t)});var S=function(){u.pandoraiframe||(u.pandoraiframe=$("<iframe>").appendTo("body")),u.pandoraiframe.attr("src","http://www.pandora.com")},D=function(){u.pandoraiframe.remove(),u.pandoraiframe=null};chrome.runtime.onUpdateAvailable.addListener(function(){chrome.runtime.reload()});var V=function(){chrome.runtime.requestUpdateCheck(function(){}),V.shown=!0,open("/update.html","scupdate","chrome,innerWidth=600,innerHeight=250,left="+(screen.width-600)/2+",top="+((screen.height-250)/2-100))},U={};window.addEventListener("online",function(){for(var e in U)"ping"==e&&L(),delete U[e]},!0);var L=function(e){return navigator.onLine?void $.post("http://soundcontrolplus.com/api/ping/",JSON.stringify({clid:t.id,time:i.firstinstalled,htok:i.token?sjcl.codec.hex.fromBits(sjcl.hash.sha1.hash(i.token)):void 0,version:chrome.runtime.getManifest().version,lang:navigator.language,storagefailed:s.failed,meta:{active:i.active}})).done(function(a){return a?("string"==typeof a&&(a=JSON.parse(a)),a.alert&&alert(a.alert),a.notif&&webkitNotifications.createNotification("/im/icon128.png",a.notif.title,a.notif.descrip).show(),a.checkupdate&&chrome.runtime.requestUpdateCheck(function(){}),3==a.code&&(y=function(e){p=e}),a.settoken&&n({token:a.settoken}),h=-1!=["plus","1yrplus","6mnplus","1mnplus","2wkplus","1wkplus","1dyplus","lite","1yrlite","6mnlite","1mnlite","2wklite","1wklite","1dylite"].indexOf(a.licenseid)?a.licenseid:"",o({license:h}),o({license_expires:a.expires}),a.invalidtoken&&i.token&&n({invalidtoken:i.token}),window.pinged=!0,$.post("http://soundcontrolplus.com/id?c="+t.id+"&f="+i.firstinstalled+"&l="+(t.license||"")),void(e&&e())):void setTimeout(L,3e4)}).fail(function(){setTimeout(L,3e4)}):void(U.ping=!0)},E=function(){$(function(){chrome.runtime.setUninstallUrl&&chrome.runtime.setUninstallUrl("http://soundcontrolplus.com/api/uninstall/?clid="+t.id),f.setPopup(),W(),A(),i.hidetab&&"pandora"==t.activeplayer&&S(),P(),O(),L(),setInterval(L,864e5*(.4*Math.random()+.8)),g.updateActive()})},W=function(){chrome.tabs.getSelected(null,function(e){e&&(u.lasttabid=e.id)}),chrome.tabs.onActivated.addListener(function(e){p&&e.tabId==p._tabid||(u.lasttabid=e.tabId)}),chrome.windows.onFocusChanged.addListener(function(){chrome.tabs.getSelected(null,function(e){!e||p&&e.id==p._tabid||(u.lasttabid=e.id)})})},A=function(){chrome.extension.onConnect.addListener(function(e){var t=JSON.parse(e.name);if("playerport"==t.name){if("pandora"==t.type)for(var i=0;i<m.length;i++)m[i].type==t.type&&(m[i]._tabid>=0?chrome.tabs.remove(m[i]._tabid):D());var o=new d(e,t.type);y(o),o.onmessage(t),H(),console.log("con",t.type,m),p&&!m.length&&(x=function(){p&&(p.disconnect(),p=null)})}})},P=function(){chrome.runtime.onMessage.addListener(function(e,t){t.tab&&(e.injecturl&&C({url:e.injecturl,id:t.tab.id},!1,!0),e.injecttype&&-1!==["youtube","audiovideo","all_urls","playspotify"].indexOf(e.injecttype)&&chrome.tabs.executeScript(t.tab.id,{file:"js/"+e.injecttype+".js",allFrames:!0},l.bind(null,"execmessage")))}),chrome.windows.getAll({populate:!0},function(e){for(var t=0;t<e.length;t++)for(var i=0;i<e[t].tabs.length;i++)C(e[t].tabs[i],!0)}),chrome.tabs.onUpdated.addListener(function(e,t,i){"complete"==t.status&&C(i)})},O=function(){chrome.commands&&chrome.commands.onCommand&&chrome.commands.onCommand.addListener(function(e){!t.license&&t.installed>14085972e5&&c("Keyboard Shortcuts"),_(e)})};Date.now()/1e3>1421733600&&(y=function(e){p=e});var H=function(){g.updateActive(),f.setIcon(),f.setTitle()};f={},f.lastClicked=0,f.numClicks=0,f.timeout=null,f.unfreezeIconTime=null,f.clicktime=500,f.displayart=null,f.canvas=document.createElement("canvas"),f.artblacklist=[],f.imgbuffer=null,f.imgbufferpath=null,f.disableuntil=0,f.showpopup=!1,f.updateIcon=function(){f.canvas.width=19,f.canvas.height=19;var e=f.canvas.getContext("2d");e.putImageData(f.imgbuffer,0,0),p&&(f.displayart&&p.isplaying?(e.fillStyle={googlemusic:"rgba(255,133,0,1)",youtube:"rgba(170,0,0,1)",grooveshark:"#f66c00",digitallyimported:"#288cfb",soundcloud:"#FF8300",playspotify:"#86b410",cmdfm:"#fff",amazoncloud:"#f90",audiovideo:"#86b410",songza:"#0069ff",rdio:"#fff",stitcher:"#1891c7",iheart:"#ca2127","8tracks":"#000",beatsmusic:"#e51937",slacker:"#0098d7",tunein:"#000",radio:"#000",earbits:"#000"}[p.type]||"#5b9aef",e.fillRect(0,18,19*p.elapsedTime/p.totalTime,1),e.fillStyle={googlemusic:"rgba(204,204,204,1)",youtube:"rgba(100,100,100,1)",grooveshark:"#383838",digitallyimported:"#e6e6e6",soundcloud:"#343434",playspotify:"#343434",cmdfm:"#000",amazoncloud:"#666",audiovideo:"#86b410",songza:"#000c1f",rdio:"#222",stitcher:"#555",iheart:"#f7f7f7","8tracks":"#fff",beatsmusic:"#fff",slacker:"#fff",tunein:"#fff",radio:"#fff",earbits:"#fff"}[p.type]||"#0f304f",e.fillRect(19*p.elapsedTime/p.totalTime,18,19-19*p.elapsedTime/p.totalTime,1)):(e.fillStyle={googlemusic:"rgba(255,133,0,1)",grooveshark:"#f66c00",digitallyimported:"#288cfb",soundcloud:"#FF8300",playspotify:"#86b410",cmdfm:"#000",amazoncloud:"#f90",audiovideo:"#86b410",songza:"#0069ff",rdio:"#fff",stitcher:"#1891c7",iheart:"#ca2127","8tracks":"#000",beatsmusic:"#e51937",slacker:"#0098d7",tunein:"#000",radio:"#000",earbits:"#000"}[p.type]||"#5b9aef",e.fillRect(1,17,1+17*p.elapsedTime/p.totalTime,1))),chrome.browserAction.setIcon({imageData:e.getImageData(0,0,19,19)})},f.setIcon=function(e,t){if(f.unfreezeIconTime){var o=(new Date).getTime();if(f.unfreezeIconTime>o&&f.unfreezeIconTime<o+2e3)return void setTimeout(function(){f.setIcon(e,t)},f.unfreezeIconTime-o+1);f.unfreezeIconTime=null}if(f.displayart=p&&p.isplaying&&i.artbutton&&p.albumart&&-1==f.artblacklist.indexOf(p.albumart),e||(e=f.displayart?p.albumart:p&&p.isplaying?"im/action-pause.png":"im/action-play.png"),e==f.imgbufferpath)f.updateIcon();else{var n=new Image;n.onload=function(){var t=n.width,i=n.height,o=Math.min(t,i);f.canvas.width=o,f.canvas.height=o;var a=f.canvas.getContext("2d");a.clearRect(0,0,o,o),a.drawImage(n,(t-o)/2,(i-o)/2,o,o,0,0,o,o);try{var s=a.getImageData(0,0,o,o).data}catch(r){return console.log("imagedataerr",r),f.canvas=document.createElement("canvas"),f.artblacklist.push(e),void f.setIcon()}var l=new Resize(o,o,19,19,!0,!0,!1,function(t){f.canvas.width=19,f.canvas.height=19,a=f.canvas.getContext("2d"),f.imgbuffer=a.createImageData(19,19),f.imgbufferpath=e;for(var i=f.imgbuffer.data,o=i.length,n=0;o>n;n++)i[n]=255&t[n];a.putImageData(f.imgbuffer,0,0),f.updateIcon()});l.resize(s)},n.src=e}t&&(f.unfreezeIconTime=(new Date).getTime()+t,f.setIcon())},f.setTitle=function(){var e=p?(1==p.songvote?"▲ ":-1==p.songvote?"▼ ":"")+(p.song?p.song:"")+(p.artist?"\n by: "+p.artist:"")+(p.album?"\n on: "+p.album:""):"";chrome.browserAction.setTitle({title:e})},f.setPopup=function(e){void 0===e&&(e="popup"==i.clickset[0]&&!g.isready),f.showpopup!=e&&(f.showpopup=e,chrome.browserAction.setPopup({popup:e?"popup.html":""}))},f.doaction=function(){var e=f.numClicks,t=i.clickset[e-1];t&&(console.log("**doaction",e,t),f.setPopup(),_(t))},f.onclick=function(){Date.now()<f.disableuntil||(Date.now()-f.lastClicked>f.clicktime?f.numClicks=1:f.numClicks++,clearTimeout(f.timeout),f.timeout=setTimeout(f.doaction,i.clickset[f.numClicks]?f.clicktime:0),"popup"!=i.clickset[f.numClicks-1]&&g.window&&(g.isready?g.window.close():g.doclose=!0),f.setPopup("popup"==i.clickset[f.numClicks]),f.lastClicked=Date.now())},chrome.browserAction.onClicked.addListener(f.onclick),g=$("<div id=popup>")[0],v=function(e,t){return g.ownerDocument.defaultView&&g.ownerDocument.defaultView.$?g.ownerDocument.defaultView.$(e,t?t:g):function(){}},g.isready=!1,g.ready=function(){if(g.doclose)return void g.window.close();g.window.document.body.style.overflowX="hidden",g.updateBigArt(0),g.updateVolume(),g.updateInfo();var e=!t.license&&Math.random()<.5;v(g)[e?"addClass":"removeClass"]("slidebanner"),v(g)[e||t.closesocial&&t.license?"removeClass":"addClass"]("slidesocial"),v("#menufullscreen, #menuoptions, #menutab").css({width:"0"}),g.window.document.addEventListener("webkitfullscreenchange",g.fullscreenChange,!0),g.updateSize(),g.dofullscreen&&g.frame&&!g.framepersistent?(v("<div id=fullscreenoverlay><div class=inner></div></div>").appendTo(g).on("click",function(){g.window.document.body.webkitRequestFullscreen()}),t.license||c("Fullscreen")):(g.dofullscreen=!1,v("#fullscreenoverlay").remove()),g.isready=!0},g.close=function(){v("#playlists").css("display","none"),g.frame=null,g.isready=!1,g.doclose=!1,g.framepersistent=!1,g.dofullscreen=!1,clearInterval(u.fullscreenart_interval),v("#fullscreenoverlay").remove(),Date.now()-f.lastClicked>f.clicktime&&f.setPopup()
},g.updateInfo=function(){g.window&&p&&(v("#play").css({display:p.isplaying?"none":"block"}),v("#pause").css({display:p.isplaying?"block":"none"}),-1==p.songvote?v("#thumbdown").addClass("active"):v("#thumbdown").removeClass("active"),1==p.songvote?v("#thumbup").addClass("active"):v("#thumbup").removeClass("active"),g.updateProgress(),v("#songtitle").text(p.song).attr("title",p.song),v("#song").css({display:p.song?"":"none"}),v("#artisttitle").text(p.artist).attr("title",p.artist),v("#artist").css({display:p.artist?"":"none"}),v("#albumtitle").text(p.album).attr("title",p.album),v("#album").css({display:p.album?"":"none"}),v("#albumart").attr("src",p.albumart),"audiovideo"!=p.type?v("#menubar .logo").css({"background-image":""}):chrome.tabs.get(p._tabid,function(e){v("#menubar .logo").css({"background-image":e&&e.favIconUrl?"url("+e.favIconUrl+")":""})}),g.updateModes(),g.updateMorePlayers(),g.updatePlaylists(),g.updateSize())},g.updateVolume=function(){g.window&&p&&(v("#volumetab").css({left:Math.round(190*p.volume-6+10)+"px"}),v("#volume").css({"background-image":p.volume?"":"url(/im/icon-mute.png)"}))},g.updateProgress=function(){g.window&&p&&(v("#progressbar").css({width:(p.totalTime?100*p.elapsedTime/p.totalTime:100)+"%"}),v("#progresstab").css({left:v(g).width()*(p.totalTime?p.elapsedTime/p.totalTime:1)-3+"px"}),v("#elapsed").text(Math.floor(p.elapsedTime/60)+":"+("0"+Math.floor(p.elapsedTime%60)).substr(-2,2)).css({display:p.totalTime||p.elapsedTime?"":"none"}),v("#remaining").text("-"+Math.floor((p.totalTime-p.elapsedTime)/60)+":"+("0"+Math.floor((p.totalTime-p.elapsedTime)%60)).substr(-2,2)).css({display:p.totalTime-p.elapsedTime>0?"":"none"}).css({display:p.totalTime?"":"none"}))},g.updatePlaylists=function(){if(g.window&&p){v("#playlists").empty();var e=p.playlists||[];t.playlistsort&&"none"!=t.playlistsort&&e.sort("alpha"==t.playlistsort?null:function(){return 0});for(var i=0;i<e.length;i++)v("#playlists").append($("<div class=playlist>").attr("title",e[i]).addClass(e[i]==p.playlist?"active":"").text(e[i]).on("click",function(){v(".playlist.active").removeClass("active"),v("#showplaylist").text(""),p.setplaylist(v(this).attr("title"))}));v("#showplaylist").text(p.playlist),g.updateSize()}},g.updateModes=function(){g.window&&p&&(v("#moderepeat").attr("mode",p.moderepeat?"on":"off"),v("#modeshuffle").attr("mode",p.modeshuffle?"on":"off"))},g.updateMorePlayers=function(){for(var e=1;e<m.length;e++)v("#moreplayer"+e+" .moreplay").css({display:m[e].isplaying?"none":"block"}),v("#moreplayer"+e+" .morepause").css({display:m[e].isplaying?"block":"none"}),v("#moreplayer"+e+" .moresong").text(m[e].song+(m[e].song&&m[e].artist?" - ":"")+m[e].artist),v("#moreplayer"+e+" .moreinterrupted").css({display:m[e].interrupted?"block":"none"}),"audiovideo"!=m[e].type?v("#moreplayer"+e+" .morelogo").css({"background-image":""}):chrome.tabs.get(m[e]._tabid,function(e,t){v("#moreplayer"+e+" .morelogo").css({"background-image":t&&t.favIconUrl?"url("+t.favIconUrl+")":""})}.bind(null,e));g.updateSize()},g.updateActive=function(){p?(v(g).removeClass("nullplayer"),v("#playerdash, #currentsong, #menubar, #playlists").attr("ptype",p.type)):(v(g).addClass("nullplayer"),v("#play, #pause").css({display:""}),v("#playerdash, #currentsong, #menubar, #playlists").attr("ptype",k())),v("#moreplayers").empty();for(var e=1;e<m.length;e++)v("#moreplayers").append($("<div id=moreplayer"+e+" class=moreplayer>").attr("ptype",m[e].type).append($("<div class=moreplay>").click(m[e].play.bind(m[e]))).append($("<div class=morepause>").click(m[e].pause.bind(m[e]))).append($("<div class=morelogo>").click(function(e){e&&(e._tabid>=0?i.hidetab&&"pandora"==e.type?S():chrome.tabs.get(e._tabid,function(e){chrome.windows.update(e.windowId,{focused:!0}),chrome.tabs.update(e.id,{active:!0})}):chrome.tabs.create({url:"http://www.pandora.com",active:!0,pinned:i.pintab.pandora}))}.bind(null,m[e]))).append($("<div class=moreinterrupted>").text("⟳").attr("title","cancel auto-resume").click(function(){this.interrupted=!1,g.updateMorePlayers()}.bind(m[e]))).append($("<div class=moresong>")).append($("<div class=clear>")));g.updateVolume(),g.updateInfo()},g.updateBigArt=function(e){if(i.bigart){var t=v("#scrollframe").width();v("#currentsong").css({position:"relative"}).animate({padding:"0"},e),v("#songinfo").css({position:"absolute",right:"59px",bottom:"8px"}).animate({right:"0",bottom:"8px"},e),v("#song").css({"white-space":"normal"}),v("#albumart").animate({width:t+"px",height:t*v("#albumart").height()/v("#albumart").width()+"px"},e,function(){v("#albumart").css({width:"100%",height:"auto"}),v("#currentsong").css({"min-height":"84px"}),g.updateSize()})}else{var t=v("#albumart").width(),o=v("#albumart").height();t>o?(t*=51/o,o=51):(o*=51/t,t=51),v("#currentsong").css({"min-height":""}).animate({"padding-top":"8px","padding-right":"8px","padding-bottom":"8px","padding-left":"0"},e),v("#songinfo").animate({right:"59px",bottom:"8px"},e,function(){v("#currentsong").css({position:"",padding:""}),v("#songinfo").css({position:"",right:"",bottom:""}),v("#song").css({"white-space":""})}),v("#albumart").animate({width:t+"px",height:o+"px"},e,function(){v("#albumart").css({width:"",height:""}),g.updateSize()})}},g.updateSize=function(){if(g.frame&&g.window&&!g.window.document.webkitFullscreenElement){var e=function(){g.frame&&g.window&&!g.window.document.webkitFullscreenElement&&(!g.framechrome&&g.frame.innerWidth&&g.frame.innerHeight&&g.frame.outerWidth>=g.frame.innerWidth&&g.frame.outerHeight>g.frame.innerHeight&&(console.log("framechrome",g.framechrome,JSON.stringify({inner:{width:g.frame.innerWidth,height:g.frame.innerHeight},outer:{width:g.frame.outerWidth,height:g.frame.outerHeight}})),g.framechrome={},g.framechrome.width=Math.max(g.frame.outerWidth-g.frame.innerWidth,0),g.framechrome.height=Math.max(g.frame.outerHeight-g.frame.innerHeight,0)),g.framechrome&&!g.dofullscreen&&(g.offsetWidth>g.window.document.documentElement.offsetWidth?g.framescrollwidth=g.offsetWidth-g.window.document.documentElement.offsetWidth:(g.offsetWidth<g.window.document.documentElement.offsetWidth||!g.framescrollwidth)&&(g.framescrollwidth=0),g.framesize.width=g.framechrome.width+g.offsetWidth+g.framescrollwidth,g.framesize.height=g.framechrome.height+g.offsetHeight,g.framesize.height=Math.min(g.framesize.height,screen.availHeight-g.frame.screenTop-10),g.frame.resizeTo(g.framesize.width,g.framesize.height)))};clearTimeout(g.framesize_timeout1),clearTimeout(g.framesize_timeout2),clearTimeout(g.framesize_timeout3),clearTimeout(g.framesize_timeout4),e(),g.framesize_timeout1=setTimeout(e,100),g.framesize_timeout2=setTimeout(e,500),g.framesize_timeout3=setTimeout(e,1e3),g.framesize_timeout4=setTimeout(e,2e3)}},g.fullscreenChange=function(){if(v("#menufullscreen, #menuoptions, #menutab").css({width:"0"}),g.window)if(g.window.document.webkitFullscreenElement){v(g).addClass("fullscreen");var e=2e4,t=function(){var t=1+.2*Math.random(),i=v(g).width()*t,o=v("#albumart").height()/v("#albumart").width()*i,n=v(g).height()-o+Math.random()*(58-v(g).height()+o),a=v(g).width()-i+Math.random()*(-v(g).width()+i),s=100*t;v("#albumart").stop().animate({top:n+"px",left:a+"px",width:s+"%"},e-1e3)};t(),u.fullscreenart_interval=setInterval(t,e),g.dofullscreen=!1,v("#fullscreenoverlay").remove()}else v(g).removeClass("fullscreen"),clearInterval(u.fullscreenart_interval),v("#albumart").stop().css({top:"",left:"",width:""}),g.updateBigArt(0),g.updateSize(),g.onblur()},g.onblur=function(){g.frame&&g.window&&!g.window.document.webkitFullscreenElement&&!g.framepersistent&&g.window.close()};var R=function(e){window.volumeDown&&(p.volume=(e.clientX-40-(v(g).width()-250))/190,p.volume<0&&(p.volume=0),p.volume>1&&(p.volume=1),p.setvolume(p.volume),g.updateVolume())},N=function(){g.window&&g.window.close(),setTimeout(function(){f.disableuntil=Date.now()+1e3,g.frame=open(chrome.runtime.getURL("popup.html"),"popup","chrome,innerWidth=250,innerHeight=200,left="+(screen.availWidth-250)/2+",top="+((screen.availHeight-300)/2-100)),g.framesize={width:250,height:200},g.framechrome=null},500)};v(g).addClass("nullplayer").append($("<div id=banner>").append($("<span class=upgradebutton>Get SoundControl<span class=scplus> plus<span class=arrow> &#x276F;</span></span></span>").click(function(){chrome.tabs.create({url:"http://soundcontrolplus.com/id/?clid="+t.id+"&fi="+i.firstinstalled+"&n=/pay/"})}).mouseenter(function(){$(".scplus",this).stop().animate({left:".4em"},100)}).mouseleave(function(){$(".scplus",this).stop().animate({left:"0"},200)}))).append($("<div id=socialbar>").append('<iframe id="flikeButtonIframe" src="https://www.facebook.com/plugins/like.php?href=https://chrome.google.com/webstore/detail/soundcontrol/dckjilenognecmpjjpeckgekikdpchli&amp;width=450&amp;height=21&amp;colorscheme=light&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;share=true&amp;send=false" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:120px; height:21px;" allowtransparency="true"></iframe>').append('<iframe id="gplusButtonIframe" frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" src="https://apis.google.com/u/0/_/+1/fastbutton?usegapi=1&bsv=o&size=medium&annotation=bubble&hl=en&origin=https%3A%2F%2Fchrome.google.com&url=https%3A%2F%2Fchrome.google.com%2Fwebstore%2Fdetail%2Fsoundcontrol-free-for-pan%2Fdckjilenognecmpjjpeckgekikdpchli" title="+1" style="height: 20px; width: 75px;"></iframe>').append('<iframe id="tweetButtonIframe" allowtransparency="true" frameborder="0" scrolling="no" src="https://platform.twitter.com/widgets/tweet_button.html?count=none&lang=en&url=https%3A%2F%2Fchrome.google.com%2Fwebstore%2Fdetail%2Fsoundcontrol%2Fdckjilenognecmpjjpeckgekikdpchli&text=Control%20pandora%20and%20other%20web%20music%20with%201%20click:" style="width:75px; height:21px;"></iframe>').append($("<div id=socialclose>").click(function(){t.license?(o({closesocial:!0}),v(g).removeClass("slidesocial")):open(chrome.runtime.getURL("promo2.html"),"promo2","width=700,height=400,left="+(screen.availWidth/2-350)+",top="+(screen.availHeight/2-200-50))}))).append($("<div id=playerdash>").append($("<div id=playerbuttons>").append($("<div id=volumepanel>").mouseover(function(){v("#volumepanel").stop().css({display:"block"}).animate({opacity:1})}).mouseout(function(){v("#volumepanel").stop().animate({opacity:0},function(){v(this).css({display:""})})}).append($("<div id=volumeslider>").mousedown(function(e){return window.volumeDown=!0,R(e),!1}).mouseup(function(){window.volumeDown=!1}).mouseover(R).append($("<div id=volumebar>").mouseover(R)).append($("<div id=volumetab>").mouseover(R)))).append($("<div id=volume>").mouseover(function(){v("#volumepanel").stop().css({display:"block"}).animate({opacity:1})}).mouseout(function(){v("#volumepanel").stop().animate({opacity:0},function(){v(this).css({display:""})})}).click(function(){p.volume?(window._memVolume=p.volume,p.volume=0):p.volume=window._memVolume?window._memVolume:1,p.setvolume(p.volume),g.updateVolume()})).append($("<div id=thumbdown>").click(function(){$(this).is(".active")?p.setsongvote(0):p.thumbdown()})).append($("<div id=thumbup>").click(function(){$(this).is(".active")?p.setsongvote(0):p.thumbup()})).append($("<div id=prev>").click(function(){p.prev()})).append($("<div id=play>").click(function(){x(function(){p.play()})})).append($("<div id=pause>").click(function(){p.volume>0&&I(),p.pause()})).append($("<div id=next>").click(function(){p.next()})).append($("<div id=tired title='tired of this song'>").click(function(){p.tired()})).append($("<div id=moderepeat title='repeat'>").click(function(){p.togglerepeat()})).append($("<div id=modeshuffle title='shuffle'>").click(function(){p.toggleshuffle()}))).append($("<div id=progress>").append($("<div id=progressbar>")).append($("<div id=elapsed>")).append($("<div id=remaining>")).append($("<div id=progressoverlay>").click(function(e){p.seek(e.clientX/v(g).width())}).append($("<div id=progresstab>"))))).append($("<div id=scrollframe>").append($("<div id=currentsong>").append($("<img id=albumart>").click(function(){g.window&&g.window.document.webkitFullscreenElement||(n({bigart:!i.bigart}),g.updateBigArt())})).append($("<div id=songinfo>").append($("<div id=song>").append($("<span class=textover>").append($("<a id=songtitle>").click(function(){})))).append($("<div id=artist>").append($("<span class=textover>").append("by: ").append($("<a id=artisttitle>")))).append($("<div id=album>").append($("<span class=textover>").append("on: ").append($("<a id=albumtitle>"))))).append($("<div class=clear>"))).append($("<div id=menubar>").append($("<div id=menutab class=button>").append("<div class=logo>").append("Tab").click(function(){p&&(p._tabid>=0?i.hidetab&&"pandora"==p.type?S():chrome.tabs.get(p._tabid,function(e){chrome.windows.update(e.windowId,{focused:!0}),chrome.tabs.update(e.id,{active:!0})}):chrome.tabs.create({url:"http://www.pandora.com",active:!0,pinned:i.pintab.pandora}))}).mouseenter(function(){v(this).stop().animate({width:"2em"},100).css({color:""})}).mouseleave(function(){v(this).stop().animate({width:"0"},100,function(){$(this).css({color:"transparent"})})}).css({color:"transparent"})).append($("<div id=menuoptions class=button>").append("<div class=icon>").append("Options").click(function(){chrome.tabs.create({url:chrome.extension.getURL("options.html")})}).mouseenter(function(){v(this).stop().animate({width:"3.6em"},100)}).mouseleave(function(){v(this).stop().animate({width:"0"},100)})).append($("<div id=menutimer class=button>").append("<div class=icon>").append("Timer").click(function(){M.time?M.off():M.on()}).mouseenter(function(){v(this).stop().animate({width:"3.6em"},100)}).mouseleave(function(){v(this).stop().animate({width:"0"},100)})).append($("<div id=menufullscreen class=button>").append("<div class=icon>").append("Fullscreen").click(function(){g.frame?g.window&&(g.window.document.webkitFullscreenElement?g.window.document.webkitExitFullscreen():g.window.document.body.webkitRequestFullscreen()):(g.window&&g.window.close(),setTimeout(function(){g.dofullscreen=!0,N()},500))}).mouseenter(function(){v(this).stop().animate({width:"4.8em"},100)}).mouseleave(function(){v(this).stop().animate({width:"0"},100)})).append($("<div id=menuplaylists class=button>").append("<div class=icon>").append("<span id=showplaylist>Playlists</span>").click(function(){"none"==v("#playlists").css("display")?v("#playlists").slideDown():v("#playlists").slideUp(),setTimeout(g.updateSize,100)})).append($("<div class=clear>"))).append($("<div id=playlists>")).append($("<div id=moreplayers>"))),window.ping=L,window.button=f,window.popup=g}();